

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Database file import into M-Files &mdash; MFSQL Connector 4.9.27.69 documentation</title>
  

  
  
    <link rel="shortcut icon" href="../../_static/MFSQL-Favicon.ico"/>
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Installing the Connector" href="../installing-the-connector/index.html" />
    <link rel="prev" title="MFSQL Database File Connector" href="../index.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> MFSQL Connector
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">FAQ:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../faq/index.html">Frequently asked questions</a></li>
</ul>
<p class="caption"><span class="caption-text">MFSQL Connector Guide:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../introduction/index.html">Introduction to MFSQL</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../getting-started/index.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../mfsql-data-exchange-and-reporting-connector/index.html">MFSQL Data Exchange and reporting Connector</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">MFSQL Database File Connector</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Database file import into M-Files</a></li>
<li class="toctree-l2"><a class="reference internal" href="../installing-the-connector/index.html">Installing the Connector</a></li>
<li class="toctree-l2"><a class="reference internal" href="../configuring-the-file-connector/index.html">Configuring the File Connector</a></li>
<li class="toctree-l2"><a class="reference internal" href="../connector-specific-settings/index.html">Connector Specific Settings</a></li>
<li class="toctree-l2"><a class="reference internal" href="../authenticate-connection/index.html">Authenticate Connection</a></li>
<li class="toctree-l2"><a class="reference internal" href="../functional-checklist/index.html">Functional Checklist</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../mfsql-integration-connector/index.html">MFSQL Integration Connector</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../the-connector-framework/index.html">The Connector Framework</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../version-control/index.html">Version Control</a></li>
</ul>
<p class="caption"><span class="caption-text">Blog:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../blogs/index.html">List of blogs</a></li>
</ul>
<p class="caption"><span class="caption-text">SQL Components:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../procedures/index.html">Procedures</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tables/index.html">Tables</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../functions/index.html">Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../views/index.html">Views</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">MFSQL Connector</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">MFSQL Database File Connector</a> &raquo;</li>
        
      <li>Database file import into M-Files</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="database-file-import-into-m-files">
<h1>Database file import into M-Files<a class="headerlink" href="#database-file-import-into-m-files" title="Permalink to this headline">¶</a></h1>
<div class="confluence-information-macro has-no-icon confluence-information-macro-information docutils container">
<p>Description</p>
<div class="confluence-information-macro-body docutils container">
<p>Use the spmfExportFiletoMFiles procedure to export a file in a
database blob to M-Files.</p>
<p>This will allow for a file that is stored in a database that is
accessible as a view or table in MFSQL Connector database to be
extracted and imported into M-Files.  There is a number of key
elements and pre-requisites to set this up.</p>
<ul class="simple">
<li><p>A new text property with the name  Mfsql_File_Unique_Ref is
added to the metadata of the target class.  For instance, if
image files will be imported into the Drawing Class in M-Files
then  Mfsql_File_Unique_Ref must be added in M-Files as a
property and added to the Drawing Class in M-Files.</p></li>
<li><p>Note the setting in MFSettings for the location of the
temporary folder on the SQL server to be used during the
processing of the file transfer.  The procedure will
temporarily save the file in this folder, and then use M-Files
API’s to import the file into M-Files and link it with the
metadata.</p></li>
<li><p>A table or view must exist with the following minimum columns</p>
<ul>
<li><p>The Image in a blob format. This is usually a data type of
bit or nvarchar(max)</p></li>
<li><p>The name of the file</p></li>
<li><p>A unique reference for the image</p></li>
</ul>
</li>
<li><p>Add or update the record to be updated in the MFSQL Connector
class table by updating the Mfsql_File_Unique_Ref column and
any additional metadata to be added / updated for the record.
This is usually done by having a select statement with a join
between all the related data in the image file database to
extract all the relevant data from the third party database.
Set the process_id of the table to 5.</p></li>
<li><p> Execute the above procedure.</p>
<ul>
<li><p>if the record in the class table is new, a new single file
object will be created in M-Files with the relevant metadata</p></li>
<li><p>if the record exist and the file is new, the record will be
set as a multi file document and the new file will be
added.  A new file is where name of the file is different
from another file in the multi-files of the specific object</p></li>
<li><p>If the record exist and there is already a file in the
multi-file document with the same name, then to file in
M-Files will be overwritten.</p></li>
</ul>
</li>
<li><p>The procedure will allow for specifying the size of the batches
to be imported. This will allow for importing larger volumes of
files in segments.</p></li>
</ul>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
</div>
<div class="confluence-information-macro confluence-information-macro-information docutils container">
<p>Availability</p>
<div class="confluence-information-macro-body docutils container">
<div class="table-wrap docutils container">
<table class="docutils align-default">
<colgroup>
<col style="width: 58%" />
<col style="width: 42%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Module</p></th>
<th class="head"><p>Release#</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Integration</p></td>
<td><p>3.1.5.41</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="confluence-information-macro confluence-information-macro-tip docutils container">
<div class="confluence-information-macro-body docutils container">
<p>The  Mfsql_File_Unique_Ref property is automatically added to the
vault when the content package is installed during the
installation routine.</p>
<p>The folder on the SQL Server to be used as the temporary file
export folder is automatically created during the installation
routine as c:MFSQLFileImport.</p>
</div>
</div>
<div class="confluence-information-macro confluence-information-macro-warning docutils container">
<div class="confluence-information-macro-body docutils container">
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
</div>
<div class="confluence-information-macro confluence-information-macro-information docutils container">
<p>Parameters</p>
<div class="confluence-information-macro-body docutils container">
<div class="table-wrap docutils container">
<table class="docutils align-default">
<colgroup>
<col style="width: 24%" />
<col style="width: 76%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Procedure Name</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>Inputs</p></td>
<td><p>Debug: 1 = Debug Mode; 0 = No Debug (default)</p></td>
</tr>
<tr class="row-even"><td><p>Outputs</p></td>
<td><p>1 = success</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>Review the folder location for the file import</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="code panel pdl docutils container">
<div class="codecontent panelcontent pdl docutils container">
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">mfsettings</span> <span class="k">WHERE</span> <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;FileTransferLocation&#39;</span>
</pre></div>
</div>
</div>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="code panel pdl docutils container">
<div class="codeheader panelheader pdl docutils container">
<p><strong>Execute Procedure</strong></p>
</div>
<div class="codecontent panelcontent pdl docutils container">
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="c1">-------------------------------------------------------------------------------------------------------------------------</span>
<span class="k">exec</span> <span class="n">spMFCreateTable</span> <span class="s1">&#39;Drawing&#39;</span>
<span class="k">exec</span> <span class="n">spmfupdatetable</span> <span class="s1">&#39;MFDrawing&#39;</span><span class="p">,</span><span class="mi">1</span>
<span class="k">select</span> <span class="o">*</span> <span class="k">from</span> <span class="n">MFDrawing</span>
<span class="c1">-------Add New File to existing object -----------------------</span>
<span class="k">update</span> <span class="n">MFDrawing</span> <span class="k">set</span> <span class="n">Process_id</span><span class="o">=</span><span class="mi">5</span> <span class="k">where</span> <span class="n">fileobjectid</span><span class="o">=</span><span class="s1">&#39;1&#39;</span>

<span class="c1">--in this example to ImageFiles view containts the extract of the files to be imported</span>

<span class="k">EXEC</span> <span class="n">SynchronizeFilesToMFiles</span> <span class="s1">&#39;ImageFiles&#39;</span><span class="p">,</span><span class="s1">&#39;ID&#39;</span><span class="p">,</span><span class="s1">&#39;FileName&#39;</span><span class="p">,</span><span class="s1">&#39;File&#39;</span><span class="p">,</span><span class="s1">&#39;Drawing&#39;</span><span class="p">,</span><span class="mi">500</span>

<span class="k">select</span> <span class="o">*</span> <span class="k">from</span> <span class="n">ImageFiles</span>

<span class="c1">-----------------Over write File-----------------------</span>
<span class="k">exec</span> <span class="n">spmfupdatetable</span> <span class="s1">&#39;MFOrder&#39;</span><span class="p">,</span><span class="mi">1</span>
<span class="k">update</span> <span class="n">MFDrawing</span> <span class="k">set</span> <span class="n">Process_id</span><span class="o">=</span><span class="mi">5</span> <span class="k">where</span> <span class="n">fileobjectid</span><span class="o">=</span><span class="s1">&#39;6&#39;</span>

<span class="k">EXEC</span> <span class="n">SynchronizeFilesToMFiles</span> <span class="s1">&#39;ImageFiles&#39;</span><span class="p">,</span><span class="s1">&#39;ID&#39;</span><span class="p">,</span><span class="s1">&#39;FileName&#39;</span><span class="p">,</span><span class="s1">&#39;File&#39;</span><span class="p">,</span><span class="s1">&#39;Drawing&#39;</span><span class="p">,</span><span class="mi">500</span>

<span class="c1">-------------------------------Adding File to MultiFile Document-----------------------</span>

<span class="k">update</span> <span class="n">MFDrawing</span> <span class="k">set</span> <span class="n">process_id</span><span class="o">=</span><span class="mi">5</span> <span class="k">where</span> <span class="n">fileobjectid</span><span class="o">=</span><span class="s1">&#39;2&#39;</span>

<span class="k">EXEC</span> <span class="n">SynchronizeFilesToMFiles</span> <span class="s1">&#39;ImageFiles&#39;</span><span class="p">,</span><span class="s1">&#39;ID&#39;</span><span class="p">,</span><span class="s1">&#39;FileName&#39;</span><span class="p">,</span><span class="s1">&#39;File&#39;</span><span class="p">,</span><span class="s1">&#39;Drawing&#39;</span><span class="p">,</span><span class="mi">500</span>
</pre></div>
</div>
</div>
</div>
<div class="confluence-information-macro confluence-information-macro-information docutils container">
<p>Use Cases(s)</p>
<div class="confluence-information-macro-body docutils container">
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../installing-the-connector/index.html" class="btn btn-neutral float-right" title="Installing the Connector" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../index.html" class="btn btn-neutral float-left" title="MFSQL Database File Connector" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Laminin Solutions Ltd

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>