

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Database Mail &mdash; MFSQL Connector 4.9.27.69 documentation</title>
  

  
  
    <link rel="shortcut icon" href="../../_static/MFSQL-Favicon.ico"/>
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="MFSQL Data Exchange and reporting Connector" href="../../mfsql-data-exchange-and-reporting-connector/index.html" />
    <link rel="prev" title="Set-up and working with Connector Database" href="../setup-database/index.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> MFSQL Connector
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">FAQ:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../faq/index.html">Frequently asked questions</a></li>
</ul>
<p class="caption"><span class="caption-text">MFSQL Connector Guide:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../introduction/index.html">Introduction to MFSQL</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Getting Started</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../installation-overview/index.html">Installation Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../first-time-installation/index.html">First time installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../manual-installation-using-scripts/index.html">Manual installation using scripts</a></li>
<li class="toctree-l2"><a class="reference internal" href="../licensing-management/index.html">Licensing Management</a></li>
<li class="toctree-l2"><a class="reference internal" href="../next-steps-after-installation/index.html">Next Steps after installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../next-steps-after-installation/index.html#using-example-scripts">Using example scripts</a></li>
<li class="toctree-l2"><a class="reference internal" href="../upgrades-and-hotfixes/index.html">Upgrades and hotfixes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../update-settings/index.html">Update settings</a></li>
<li class="toctree-l2"><a class="reference internal" href="../setup-database/index.html">Set-up and working with Connector Database</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Database Mail</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#send-errors-with-database-mail">Send errors with database mail</a></li>
<li class="toctree-l3"><a class="reference internal" href="#setup-database-mail">Setup database mail</a></li>
<li class="toctree-l3"><a class="reference internal" href="#scripting-database-mail-create">scripting Database Mail create</a></li>
<li class="toctree-l3"><a class="reference internal" href="#monitoring-of-database-mail">Monitoring of database mail</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#quick-steps-for-a-new-installation">Quick steps for a new installation.</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../mfsql-data-exchange-and-reporting-connector/index.html">MFSQL Data Exchange and reporting Connector</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../mfsql-database-file-connector/index.html">MFSQL Database File Connector</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../mfsql-integration-connector/index.html">MFSQL Integration Connector</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../the-connector-framework/index.html">The Connector Framework</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../version-control/index.html">Version Control</a></li>
</ul>
<p class="caption"><span class="caption-text">Blog:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../blogs/index.html">List of blogs</a></li>
</ul>
<p class="caption"><span class="caption-text">SQL Components:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../procedures/index.html">Procedures</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tables/index.html">Tables</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../functions/index.html">Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../views/index.html">Views</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">MFSQL Connector</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">Getting Started</a> &raquo;</li>
        
      <li>Database Mail</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="database-mail">
<h1>Database Mail<a class="headerlink" href="#database-mail" title="Permalink to this headline">¶</a></h1>
<div class="section" id="send-errors-with-database-mail">
<h2>Send errors with database mail<a class="headerlink" href="#send-errors-with-database-mail" title="Permalink to this headline">¶</a></h2>
<p>The Connector will automatically send an email to the support email
account defined in MFSettings if an procedure error is encountered. The error email is triggered when a new record is inserted into the
MFLog table.</p>
<p>It is therefore
recommended to have a valid email profile in the database mail
configuration for the email notifications to be sent.  Sending
notifications will automatically be disabled if Database mail is not found or
has an invalid Profile.</p>
<p>Note that it is possible to review SQL errors using a select statement
on table MFLog.</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">Select</span> <span class="n">top</span> <span class="mi">5</span> <span class="o">*</span> <span class="k">from</span> <span class="n">MFLOG</span> <span class="k">order</span> <span class="k">by</span> <span class="n">LogID</span> <span class="k">Desc</span>
</pre></div>
</div>
<p>The default Connector database user ‘MFSQLConnect’ is preconfigured to have permission to use database
mail.</p>
<p>Error management and tracing is described in  doc:: <cite>/mfsql-integration-connector/using-and-managing-logs/index</cite></p>
</div>
<div class="section" id="setup-database-mail">
<h2>Setup database mail<a class="headerlink" href="#setup-database-mail" title="Permalink to this headline">¶</a></h2>
<p>Database Mail is not active on installation of SQL by default. To use
Database Mail, you must explicitly enable Database Mail by using either
the <a class="reference external" href="https://technet.microsoft.com/en-us/library/ms175951(v=sql.105).aspx">Database Mail Configuration
Wizard</a>,
the or sp_configure stored procedure.</p>
<p>Note that Database Mail is only available in SQL express with editions
2012 SP 1 and later.</p>
<p>Setup database mail with at least one mail account and profile.  Use the default Connector profile ‘MailProfile’ or update the
profile in the table MFSettings.</p>
<p>The error mails will be sent to the email account defined in MFSettings.  By default this is set to <a class="reference external" href="mailto:support&#37;&#52;&#48;lamininsolutions&#46;com">support<span>&#64;</span>lamininsolutions<span>&#46;</span>com</a>.  Replace this setting with your internal email account for monitoring errors. Feel free to retain the support email account in MFSettings. This will allow our support team to be notified when an error occurs.</p>
</div>
<div class="section" id="scripting-database-mail-create">
<h2>scripting Database Mail create<a class="headerlink" href="#scripting-database-mail-create" title="Permalink to this headline">¶</a></h2>
<p>The following script can be used to create database mail, the profile and the account if it is not
already available in the database.</p>
<p>Setup database mail</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="n">USE</span> <span class="p">[</span><span class="n">msdb</span><span class="p">]</span>
<span class="k">GO</span>
<span class="n">sp_configure</span> <span class="s1">&#39;show advanced options&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">;</span>
<span class="k">GO</span>
<span class="n">RECONFIGURE</span><span class="p">;</span>
<span class="k">GO</span>
<span class="n">sp_configure</span> <span class="s1">&#39;Database Mail XPs&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">;</span>
<span class="k">GO</span>
<span class="n">RECONFIGURE</span>  <span class="k">GO</span>
</pre></div>
</div>
<p>Create mail account</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">EXECUTE</span> <span class="n">msdb</span><span class="p">.</span><span class="n">dbo</span><span class="p">.</span><span class="n">sysmail_add_account_sp</span>
 <span class="o">@</span><span class="n">account_name</span> <span class="o">=</span> <span class="s1">&#39;MFSQL Connector&#39;</span><span class="p">,</span>
<span class="o">@</span><span class="n">description</span> <span class="o">=</span> <span class="s1">&#39;Mail account for MFSQL Connector notifications.&#39;</span><span class="p">,</span>
<span class="o">@</span><span class="n">email_address</span> <span class="o">=</span> <span class="s1">&#39;NoReply@yourmailbox.com&#39;</span><span class="p">,</span>
<span class="o">@</span><span class="n">replyto_address</span> <span class="o">=</span> <span class="s1">&#39;support@yourmailbox.com&#39;</span><span class="p">,</span>
<span class="o">@</span><span class="n">display_name</span> <span class="o">=</span> <span class="s1">&#39;MFSQL Connector notification&#39;</span><span class="p">,</span>
<span class="o">@</span><span class="n">mailserver_name</span> <span class="o">=</span> <span class="s1">&#39;smtp.yourdomain.com&#39;</span> <span class="p">,</span>
<span class="o">@</span><span class="n">port</span> <span class="o">=</span>  <span class="mi">587</span><span class="p">,</span>
<span class="o">@</span><span class="n">username</span> <span class="o">=</span> <span class="s1">&#39;NoReply@yourmailbox.com&#39;</span><span class="p">,</span>
<span class="o">@</span><span class="n">password</span> <span class="o">=</span> <span class="s1">&#39;xxxxx&#39;</span><span class="p">,</span>
<span class="o">@</span><span class="n">enable_ssl</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">;</span>
</pre></div>
</div>
<p>Create mail profile</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">EXECUTE</span> <span class="n">msdb</span><span class="p">.</span><span class="n">dbo</span><span class="p">.</span><span class="n">sysmail_add_profile_sp</span>
<span class="o">@</span><span class="n">profile_name</span> <span class="o">=</span> <span class="s1">&#39;MailProfile&#39;</span> <span class="p">,</span>
<span class="o">@</span><span class="n">description</span> <span class="o">=</span> <span class="s1">&#39;Profile used for MFSQLConnector.&#39;</span>  <span class="p">;</span>
<span class="k">EXECUTE</span> <span class="n">msdb</span><span class="p">.</span><span class="n">dbo</span><span class="p">.</span><span class="n">sysmail_add_principalprofile_sp</span>
<span class="o">@</span><span class="n">principal_name</span> <span class="o">=</span> <span class="s1">&#39;MFSQLConnect&#39;</span><span class="p">,</span>
<span class="o">@</span><span class="n">profile_name</span> <span class="o">=</span> <span class="s1">&#39;MailProfile&#39;</span><span class="p">,</span>
<span class="o">@</span><span class="n">is_default</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">;</span>
</pre></div>
</div>
<p>Add the account to the profile</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">EXECUTE</span> <span class="n">msdb</span><span class="p">.</span><span class="n">dbo</span><span class="p">.</span><span class="n">sysmail_add_profileaccount_sp</span>
<span class="o">@</span><span class="n">profile_name</span> <span class="o">=</span> <span class="s1">&#39;MailProfile&#39;</span> <span class="p">,</span>
<span class="o">@</span><span class="n">account_name</span> <span class="o">=</span> <span class="s1">&#39;MFSQL Connector&#39;</span><span class="p">,</span>
<span class="o">@</span><span class="n">sequence_number</span> <span class="o">=</span><span class="mi">1</span> <span class="p">;</span>
</pre></div>
</div>
</div>
<div class="section" id="monitoring-of-database-mail">
<h2>Monitoring of database mail<a class="headerlink" href="#monitoring-of-database-mail" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><p>Review the setup and processing of mail with the following:</p>
</div></blockquote>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">select</span> <span class="o">*</span> <span class="k">from</span> <span class="n">msdb</span><span class="p">.</span><span class="n">dbo</span><span class="p">.</span><span class="n">sysmail_account</span>
<span class="k">select</span> <span class="o">*</span> <span class="k">from</span> <span class="n">msdb</span><span class="p">.</span><span class="n">dbo</span><span class="p">.</span><span class="n">sysmail_profile</span>
<span class="k">Select</span> <span class="o">*</span> <span class="k">from</span> <span class="n">msdb</span><span class="p">.</span><span class="n">dbo</span><span class="p">.</span><span class="n">sysmail_log</span>
<span class="k">Select</span> <span class="o">*</span> <span class="k">from</span> <span class="n">msdb</span><span class="p">.</span><span class="n">dbo</span><span class="p">.</span><span class="n">sysmail_mailitems</span>
</pre></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../../mfsql-data-exchange-and-reporting-connector/index.html" class="btn btn-neutral float-right" title="MFSQL Data Exchange and reporting Connector" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../setup-database/index.html" class="btn btn-neutral float-left" title="Set-up and working with Connector Database" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Laminin Solutions Ltd

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>