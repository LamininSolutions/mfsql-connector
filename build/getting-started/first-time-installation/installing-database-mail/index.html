

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Installing Database Mail &mdash; MFSQL Connector 4.8.24.65 documentation</title>
  

  
  
    <link rel="shortcut icon" href="../../../_static/MFSQL-Favicon.ico"/>
  
  
  

  
  <script type="text/javascript" src="../../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Common installation errors and resolutions" href="../common-installation-errors-and-resolutions/index.html" />
    <link rel="prev" title="Using Agent for automated updates" href="../using-agent-for-automated-updates/index.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../index.html" class="icon icon-home"> MFSQL Connector
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">FAQ:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../faq/index.html">Frequently asked questions</a></li>
</ul>
<p class="caption"><span class="caption-text">MFSQL Connector Guide:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../introduction/index.html">Introduction to MFSQL</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../index.html">Getting Started</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../installation-overview/index.html">Installation Overview</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../index.html">First time installation</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../standard-new-installation/index.html">Standard New Installation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../content-package-installation/index.html">Content Package installation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../installing-the-context-menu/index.html">Installing the Context Menu</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration-of-connection-string/index.html">Configuration of connection string</a></li>
<li class="toctree-l3"><a class="reference internal" href="../install-webapi/index.html">Installing the Web API</a></li>
<li class="toctree-l3"><a class="reference internal" href="../database-file-connector-installation/index.html">Database file connector installation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../using-agent-for-automated-updates/index.html">Using Agent for automated updates</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Installing Database Mail</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#to-get-mail-profile-and-account">To get mail profile and account</a></li>
<li class="toctree-l4"><a class="reference internal" href="#to-setup-database-mail">To setup database mail</a></li>
<li class="toctree-l4"><a class="reference internal" href="#to-update-email-settings-for-mfsql-connector">To update email settings for MFSQL Connector</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../common-installation-errors-and-resolutions/index.html">Common installation errors and resolutions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../setup-powershell-utilities/index.html">Setup powershell utilities</a></li>
<li class="toctree-l3"><a class="reference internal" href="../install-package-with-logging/index.html">Install package with logging</a></li>
<li class="toctree-l3"><a class="reference internal" href="../index.html#installation-scenarios">Installation scenarios</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../manual-installation-using-scripts/index.html">Manual installation using scripts</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../licensing-management/index.html">Licensing Management</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../next-steps-after-installation/index.html">Next Steps after installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../next-steps-after-installation/index.html#using-example-scripts">Using example scripts</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../upgrades-and-hotfixes/index.html">Upgrades and hotfixes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../update-settings/index.html">Update settings</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../setup-database/index.html">Set-up and working with Connector Database</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../database-mail/index.html">Database Mail</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../index.html#quick-steps-for-a-new-installation">Quick steps for a new installation.</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../mfsql-data-exchange-and-reporting-connector/index.html">MFSQL Data Exchange and reporting Connector</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../mfsql-database-file-connector/index.html">MFSQL Database File Connector</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../mfsql-integration-connector/index.html">MFSQL Integration Connector</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../the-connector-framework/index.html">The Connector Framework</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../version-control/index.html">Version Control</a></li>
</ul>
<p class="caption"><span class="caption-text">Blog:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../blogs/index.html">List of blogs</a></li>
</ul>
<p class="caption"><span class="caption-text">SQL Components:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../procedures/index.html">Views</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../tables/index.html">Tables</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../functions/index.html">Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../views/index.html">Views</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">MFSQL Connector</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../../index.html">Getting Started</a> &raquo;</li>
        
          <li><a href="../index.html">First time installation</a> &raquo;</li>
        
      <li>Installing Database Mail</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="installing-database-mail">
<h1>Installing Database Mail<a class="headerlink" href="#installing-database-mail" title="Permalink to this headline">¶</a></h1>
<p>The Connector uses Database mail to send email messages to the
designated recipient on SQL and system errors.  If database mail is not
setup the error messages are available in the table MFLOG</p>
<p>Show the most recent errors:</p>
<p>Select top 5 * from MFLOG order by LogID Desc</p>
<p>More about error management and tracing in the <a class="reference external" href="https://lamininsolutions.atlassian.net/wiki/spaces/MFSQL/pages/21200984/Error+tracing">error logging
section</a>.</p>
<p>Database Mail is not active on installation of SQL by default. To use
Database Mail, you must explicitly enable Database Mail by using either
the <a class="reference external" href="https://technet.microsoft.com/en-us/library/ms175951(v=sql.105).aspx">Database Mail Configuration
Wizard</a>,
the sp_configure stored procedure, or by using the Surface Area
Configuration facet of Policy-Based Management.</p>
<p>Note that Database Mail is only available in SQL express with editions
2012 SP 1 and later.</p>
<p>Setup database mail with at least one mail account and profile.  Add the
profile to MFSQL Connector using</p>
<div class="section" id="to-get-mail-profile-and-account">
<h2>To get mail profile and account<a class="headerlink" href="#to-get-mail-profile-and-account" title="Permalink to this headline">¶</a></h2>
<div class="line-block">
<div class="line">select * from msdb.dbo.sysmail_account</div>
<div class="line">select * from msdb.dbo.sysmail_profile</div>
</div>
</div>
<div class="section" id="to-setup-database-mail">
<h2>To setup database mail<a class="headerlink" href="#to-setup-database-mail" title="Permalink to this headline">¶</a></h2>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="code panel pdl docutils container">
<div class="codeheader panelheader pdl docutils container">
<p><strong>Execute Procedure</strong></p>
</div>
<div class="codecontent panelcontent pdl docutils container">
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span> <span class="n">USE</span> <span class="p">[</span><span class="n">msdb</span><span class="p">]</span>
<span class="k">GO</span>
<span class="c1">-- Create a Database Mail account</span>
<span class="k">EXECUTE</span> <span class="n">msdb</span><span class="p">.</span><span class="n">dbo</span><span class="p">.</span><span class="n">sysmail_add_account_sp</span>
    <span class="o">@</span><span class="n">account_name</span> <span class="o">=</span> <span class="s1">&#39;MFSQL Connector&#39;</span><span class="p">,</span>
    <span class="o">@</span><span class="n">description</span> <span class="o">=</span> <span class="s1">&#39;Mail account for MFSQL Connector notifications.&#39;</span><span class="p">,</span>
    <span class="o">@</span><span class="n">email_address</span> <span class="o">=</span> <span class="s1">&#39;NoReply@YourDomain&#39;</span><span class="p">,</span>
    <span class="o">@</span><span class="n">replyto_address</span> <span class="o">=</span> <span class="s1">&#39;support@YourDomain.com&#39;</span><span class="p">,</span>
    <span class="o">@</span><span class="n">display_name</span> <span class="o">=</span> <span class="s1">&#39;MFSQL Connector notification&#39;</span><span class="p">,</span>
    <span class="o">@</span><span class="n">mailserver_name</span> <span class="o">=</span> <span class="s1">&#39;smtp.yourSMTPserver.com&#39;</span> <span class="p">,</span>
 <span class="o">@</span><span class="n">port</span> <span class="o">=</span>  <span class="mi">25</span><span class="p">,</span>
 <span class="o">@</span><span class="n">username</span> <span class="o">=</span> <span class="s1">&#39;NoReply@YourDomain.com&#39;</span><span class="p">,</span>
  <span class="o">@</span><span class="n">password</span> <span class="o">=</span> <span class="s1">&#39;emailpassword&#39;</span><span class="p">,</span>
  <span class="o">@</span><span class="n">enable_ssl</span> <span class="o">=</span> <span class="mi">1</span>
 <span class="p">;</span>
<span class="c1">-- Create a Database Mail profile</span>
<span class="k">EXECUTE</span> <span class="n">msdb</span><span class="p">.</span><span class="n">dbo</span><span class="p">.</span><span class="n">sysmail_add_profile_sp</span>
    <span class="o">@</span><span class="n">profile_name</span> <span class="o">=</span> <span class="s1">&#39;MFSQLProfile&#39;</span><span class="p">,</span>
    <span class="o">@</span><span class="n">description</span> <span class="o">=</span> <span class="s1">&#39;Profile used for MFSQLConnector.&#39;</span> <span class="p">;</span>


<span class="c1">--Assign MFSQLConnect Principle to the Profile (to allow Context Menu messages)</span>
 <span class="k">EXECUTE</span> <span class="n">msdb</span><span class="p">.</span><span class="n">dbo</span><span class="p">.</span><span class="n">sysmail_add_principalprofile_sp</span>
    <span class="o">@</span><span class="n">principal_name</span> <span class="o">=</span> <span class="s1">&#39;MFSQLConnect&#39;</span><span class="p">,</span>
    <span class="o">@</span><span class="n">profile_name</span> <span class="o">=</span> <span class="s1">&#39;MFSQLProfile&#39;</span><span class="p">,</span>
    <span class="o">@</span><span class="n">is_default</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">;</span>

<span class="c1">-- Add the account to the profile</span>
<span class="k">EXECUTE</span> <span class="n">msdb</span><span class="p">.</span><span class="n">dbo</span><span class="p">.</span><span class="n">sysmail_add_profileaccount_sp</span>
    <span class="o">@</span><span class="n">profile_name</span> <span class="o">=</span> <span class="s1">&#39;MFSQLProfile&#39;</span> <span class="p">,</span>
    <span class="o">@</span><span class="n">account_name</span> <span class="o">=</span> <span class="s1">&#39;MFSQL Connector&#39;</span><span class="p">,</span>
    <span class="o">@</span><span class="n">sequence_number</span> <span class="o">=</span><span class="mi">1</span> <span class="p">;</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="to-update-email-settings-for-mfsql-connector">
<h2>To update email settings for MFSQL Connector<a class="headerlink" href="#to-update-email-settings-for-mfsql-connector" title="Permalink to this headline">¶</a></h2>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="code panel pdl docutils container">
<div class="codeheader panelheader pdl docutils container">
<p><strong>Execute Procedure</strong></p>
</div>
<div class="codecontent panelcontent pdl docutils container">
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">EXEC</span> <span class="p">[</span><span class="n">dbo</span><span class="p">].[</span><span class="n">spMFSettingsForDBUpdate</span><span class="p">]</span>
    <span class="o">@</span><span class="n">SupportEmailAccount</span> <span class="o">=</span> <span class="n">N</span><span class="s1">&#39;&#39;</span>
  <span class="p">,</span> <span class="c1">-- nvarchar(100)</span>
    <span class="o">@</span><span class="n">EmailProfile</span> <span class="o">=</span> <span class="n">N</span><span class="s1">&#39;&#39;</span>
</pre></div>
</div>
</div>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../common-installation-errors-and-resolutions/index.html" class="btn btn-neutral float-right" title="Common installation errors and resolutions" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../using-agent-for-automated-updates/index.html" class="btn btn-neutral float-left" title="Using Agent for automated updates" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Laminin Solutions Ltd

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>