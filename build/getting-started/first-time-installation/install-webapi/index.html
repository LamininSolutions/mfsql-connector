

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Installing the Web API &mdash; MFSQL Connector 4.9.27.69 documentation</title>
  

  
  
    <link rel="shortcut icon" href="../../../_static/MFSQL-Favicon.ico"/>
  
  
  

  
  <script type="text/javascript" src="../../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Database file connector installation" href="../database-file-connector-installation/index.html" />
    <link rel="prev" title="Configuration of connection string" href="../configuration-of-connection-string/index.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../index.html" class="icon icon-home"> MFSQL Connector
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">FAQ:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../faq/index.html">Frequently asked questions</a></li>
</ul>
<p class="caption"><span class="caption-text">MFSQL Connector Guide:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../introduction/index.html">Introduction to MFSQL</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../index.html">Getting Started</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../installation-overview/index.html">Installation Overview</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../index.html">First time installation</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../standard-new-installation/index.html">Standard New Installation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../content-package-installation/index.html">Content Package installation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../installing-the-context-menu/index.html">Installing the Context Menu</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration-of-connection-string/index.html">Configuration of connection string</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Installing the Web API</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#purpose">Purpose</a></li>
<li class="toctree-l4"><a class="reference internal" href="#architecture">Architecture</a></li>
<li class="toctree-l4"><a class="reference internal" href="#website">Website</a></li>
<li class="toctree-l4"><a class="reference internal" href="#manual-install">Manual install</a></li>
<li class="toctree-l4"><a class="reference internal" href="#removing-or-reinstalling-the-packages">Removing or reinstalling the packages</a></li>
<li class="toctree-l4"><a class="reference internal" href="#configuration-of-m-files">Configuration of M-files</a></li>
<li class="toctree-l4"><a class="reference internal" href="#testing">Testing</a></li>
<li class="toctree-l4"><a class="reference internal" href="#error-trapping">Error trapping</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../database-file-connector-installation/index.html">Database file connector installation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../using-agent-for-automated-updates/index.html">Using Agent for automated updates</a></li>
<li class="toctree-l3"><a class="reference internal" href="../common-installation-errors-and-resolutions/index.html">Common installation errors and resolutions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../setup-powershell-utilities/index.html">Setup powershell utilities</a></li>
<li class="toctree-l3"><a class="reference internal" href="../install-package-with-logging/index.html">Install package with logging</a></li>
<li class="toctree-l3"><a class="reference internal" href="../index.html#installation-scenarios">Installation scenarios</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../manual-installation-using-scripts/index.html">Manual installation using scripts</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../licensing-management/index.html">Licensing Management</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../next-steps-after-installation/index.html">Next Steps after installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../next-steps-after-installation/index.html#using-example-scripts">Using example scripts</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../upgrades-and-hotfixes/index.html">Upgrades and hotfixes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../update-settings/index.html">Update settings</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../setup-database/index.html">Set-up and working with Connector Database</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../database-mail/index.html">Database Mail</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../index.html#quick-steps-for-a-new-installation">Quick steps for a new installation.</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../mfsql-data-exchange-and-reporting-connector/index.html">MFSQL Data Exchange and reporting Connector</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../mfsql-database-file-connector/index.html">MFSQL Database File Connector</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../mfsql-integration-connector/index.html">MFSQL Integration Connector</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../the-connector-framework/index.html">The Connector Framework</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../version-control/index.html">Version Control</a></li>
</ul>
<p class="caption"><span class="caption-text">Blog:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../blogs/index.html">List of blogs</a></li>
</ul>
<p class="caption"><span class="caption-text">SQL Components:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../procedures/index.html">Procedures</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../tables/index.html">Tables</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../functions/index.html">Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../views/index.html">Views</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">MFSQL Connector</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../../index.html">Getting Started</a> &raquo;</li>
        
          <li><a href="../index.html">First time installation</a> &raquo;</li>
        
      <li>Installing the Web API</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="installing-the-web-api">
<h1>Installing the Web API<a class="headerlink" href="#installing-the-web-api" title="Permalink to this headline">¶</a></h1>
<div class="section" id="purpose">
<h2>Purpose<a class="headerlink" href="#purpose" title="Permalink to this headline">¶</a></h2>
<p>The purpose of the Web API is to provide an alternative method of connecting M-Files with the SQL Server. On premise installation is likely to use an ODBC connection to allow a user to trigger context menu actions in M-Files for processing on the SQL Server. However M-Files Cloud deployments and other scenarios where the M-Files Server is not in the same network as SQL Server can use secure https web services calls to trigger the same operations on the remote SQL server.</p>
<p>The transaction calls from M-Files to SQL does not include any metadata. It only instructs SQL to perform a store procedure which will in turn use standard M-Files connections protocols to exchange the metadata between M-Files and SQL.</p>
<p>This method is dependent on installing MFSQL Connector version 4.8.22.62 or later in the MFSQL Server.  The Vault Application should be 4.8.1.0 or later.</p>
<p>This section describes the installation of the Web API.</p>
</div>
<div class="section" id="architecture">
<h2>Architecture<a class="headerlink" href="#architecture" title="Permalink to this headline">¶</a></h2>
<p>When a context menu call is made through the MFSQLConnectorVaultApp application, it will check to see if the API url in the Configurations/Configuration/Web API Details is blank. If it is not blank, it will use the url to pass through the specific call using an encryted message string to the designated website. The website will convert the call and pass it through the database connection string to the SQL server and MFSQL Connector database. The calls that can be made using this method are restricted to the pre-designed context menu calls which includes:</p>
<ul class="simple">
<li><p>Menu action to call a store procedure or another web link</p></li>
<li><p>Menu action for a specific object to pass through the context of the object and call a store procedure</p></li>
<li><p>Workflow action to pass through the context of the object and call a store procedure</p></li>
<li><p>Event handler action to pass through the context of the object and call a store procedure.</p></li>
</ul>
<p>The Web API requires a web server with IIS 7 or later.  This Web Server must have ODBC access to the SQL Server where MFSQL Connector is installed.</p>
<p>In summary the steps for installation are:
#. Install the website for the MFSQL Web Api
#. Configure M-Files in Configurations
#. Setup or modify MFContextMenu
#. Test using M-Files desktop</p>
</div>
<div class="section" id="website">
<h2>Website<a class="headerlink" href="#website" title="Permalink to this headline">¶</a></h2>
<p>The MFSQL WEB API website for the web services calls from M-Files, is provided as a separate installation package available on request to <a class="reference external" href="mailto:support&#37;&#52;&#48;lamininsolutions&#46;com">support<span>&#64;</span>lamininsolutions<span>&#46;</span>com</a>. Note that each website is configured for a specific MFSQL Connector database and a separate instance must be installed in IIS for each vault to be connected to the specific vault MFSQL Database.</p>
<p>The site files for the Web API is also provided in the installation folder to allow for manual setup of the API and deployment of multiple vault connections to Connector databases.</p>
<p>Install the package <strong>MFSQLConnectorWebAPI</strong> on the Web Server. The installation package will run through a number of important steps</p>
<p>Execute the package
<img alt="image10" src="../../../_images/img_10.png" /></p>
<p>The copy of the site will be on the installation folder selected in the step.  To prevent to default installation of the site in IIS, uncheck the selection box.
<img alt="image11" src="../../../_images/img_111.png" /></p>
<p>The user name and password for the authentication between M-Files and the Web API is entered in the next step.  Note that the same user name and password will also be entered into the M-Files Configuration
<img alt="image12" src="../../../_images/img_121.png" /></p>
<p>In the next step the connection from the Web Server is validated. The credentials in this section is the MFSQL Connector database access credentials. The Connector installation create a user with all the required authentication by default. We recommend using MFSQLConnect user. If the password in SQL is changed for this user, then it must also be changed in the Web API.
<img alt="image13" src="../../../_images/img_131.png" /></p>
<p>The next step is to complete the installation in IIS as a web application in the default web site.  The installation will not work if there are no default web site already available in IIS. Any other web deployment scenarios can be achieved by performing a manual install.
The default application pool will be selected if it is available.</p>
<p><img alt="image14" src="../../../_images/img_141.png" /></p>
<p>The naming of the site is predetermined as MFSQLConnectWebAPI.  Naming can be changed, as long as the same name is used in the other parts of the configuration.</p>
<p><img alt="image16" src="../../../_images/img_16.png" /></p>
<p>The site files will be installed in the IISRoot folder.</p>
<p><img alt="image17" src="../../../_images/img_17.png" /></p>
<p>The website can be configured to use a SSL certificate and can be deployed as a separate application within the default website or a separate website. Update the DNS and ports to allow the url to be accessible from the M-Files Server.</p>
</div>
<div class="section" id="manual-install">
<h2>Manual install<a class="headerlink" href="#manual-install" title="Permalink to this headline">¶</a></h2>
<p>You may prefer to install the Web API in your webserver.  This may also be required when multiple vaults need to be connected to multiple MFSQL databases.  The native installation files is installed in the installation folder. By unchecking the IIS installation box during the installation process, IIS will not skipped in your Web Server technician can perform a manual Installation</p>
<p>The website files for manual installation is available in the installation folder.</p>
<p><img alt="image4" src="../../../_images/img_41.png" /></p>
<p>The following elements must be modified in the web.config file to allow the API to connect with a specific vault and database.</p>
<p>..code-block:: xml_document</p>
<blockquote>
<div><p>&lt;connectionStrings&gt;
&lt;add name=”Constr” connectionString=”Data Source=AMRUTAVPC;Initial Catalog=MFSQLRelease56;Persist Security Info=True;User ID=MFSQLConnect;Password=Connector01” providerName=”System.Data.SqlClient” /&gt;
&lt;/connectionStrings&gt;
&lt;appSettings&gt;
&lt;add key=”Username” value=”Laminin” /&gt;
&lt;add key=”Password” value=”Solution” /&gt;
&lt;/appSettings&gt;</p>
</div></blockquote>
<p>The connection string must point to the Connector database for the vault.  The default user name and password for accessing the Connector should be used.  If a different user and or password is used, then this entry must be adapted to respond to a change in settings in SQL.
The connectionstring Username and password should exist in the MFSQL Connector database.  By default the ‘’MFSQLConnect’’ SQL Authentication user is installed during the installation of the Connector.  Reference <a class="reference internal" href="../../../the-connector-framework/security/index.html"><span class="doc">Security</span></a> for more detail.</p>
<p>The ‘’appSettings’’ username and password is used to encrypt the web connection between M-Files and the Web Server.  The same username and password must be used in the configuration of M-Files.</p>
</div>
<div class="section" id="removing-or-reinstalling-the-packages">
<h2>Removing or reinstalling the packages<a class="headerlink" href="#removing-or-reinstalling-the-packages" title="Permalink to this headline">¶</a></h2>
<p>Before re-installing it is recommended to delete the Website ‘’MFSQLConnectWebAPI’’ in IIS and delete the folder with the same name in IISRoot folder.</p>
</div>
<div class="section" id="configuration-of-m-files">
<h2>Configuration of M-files<a class="headerlink" href="#configuration-of-m-files" title="Permalink to this headline">¶</a></h2>
<p>Use M-Files admin and the ‘’Configurations’’ tab complete the installation in M-Files.</p>
<p>The Web API details in the configuration tab of the MFSQL Connector Vault Application must be completed.
<img alt="image1" src="../../../_images/img_18.png" /></p>
<p>There is no need to complete any details in the connectionstring.
The API username and password must match the details used in the Web Site.
The API URL section is only visible to M-Files System Administrator.  In the case of a cloud vault, this will be completed by M-Files Support.</p>
<p>Validate the database connection in the website is point to the MFSQL Connector database when the correct details are returned to the dashboard
<img alt="image2" src="../../../_images/img_23.png" /></p>
<p>Right click and Configurations in the Vault Setup and select refresh to up the Configurator after a change has been made to activate the new details.</p>
</div>
<div class="section" id="testing">
<h2>Testing<a class="headerlink" href="#testing" title="Permalink to this headline">¶</a></h2>
<p>The best test to validate that the Web API is executing a call from M-Files to the Connector is to activate an action in the context menu.</p>
<p>Follow the <a class="reference internal" href="../installing-the-context-menu/index.html"><span class="doc">Installing the Context Menu</span></a> instruction to prepare an action to execute.</p>
<p>The table <a class="reference internal" href="../../../tables/tbMFContextMenu.html"><span class="doc">MFContextMenu</span></a> will show the date and time when the action was received and executed from M-Files.</p>
</div>
<div class="section" id="error-trapping">
<h2>Error trapping<a class="headerlink" href="#error-trapping" title="Permalink to this headline">¶</a></h2>
<p>When the settings details are not shown, an error will be displayed in the configurator error log.  The most likely error is an error in the connection string.
<img alt="image18" src="../../../_images/img_181.png" /></p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../database-file-connector-installation/index.html" class="btn btn-neutral float-right" title="Database file connector installation" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../configuration-of-connection-string/index.html" class="btn btn-neutral float-left" title="Configuration of connection string" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Laminin Solutions Ltd

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>