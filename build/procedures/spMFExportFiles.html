

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>spMFExportFiles &mdash; MFSQL Connector 4.9.27.69 documentation</title>
  

  
  
    <link rel="shortcut icon" href="../_static/MFSQL-Favicon.ico"/>
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="spMFGetDataExport" href="spMFGetDataExport.html" />
    <link rel="prev" title="spMFDropAndUpdateMetadata" href="spMFDropAndUpdateMetadata.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> MFSQL Connector
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">FAQ:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../faq/index.html">Frequently asked questions</a></li>
</ul>
<p class="caption"><span class="caption-text">MFSQL Connector Guide:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../introduction/index.html">Introduction to MFSQL</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting-started/index.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mfsql-data-exchange-and-reporting-connector/index.html">MFSQL Data Exchange and reporting Connector</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mfsql-database-file-connector/index.html">MFSQL Database File Connector</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mfsql-integration-connector/index.html">MFSQL Integration Connector</a></li>
<li class="toctree-l1"><a class="reference internal" href="../the-connector-framework/index.html">The Connector Framework</a></li>
<li class="toctree-l1"><a class="reference internal" href="../version-control/index.html">Version Control</a></li>
</ul>
<p class="caption"><span class="caption-text">Blog:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../blogs/index.html">List of blogs</a></li>
</ul>
<p class="caption"><span class="caption-text">SQL Components:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Procedures</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="spMFAddCommentForObjects.html">spMFAddCommentForObjects</a></li>
<li class="toctree-l2"><a class="reference internal" href="spMFAliasesUpsert.html">spMFAliasesUpsert</a></li>
<li class="toctree-l2"><a class="reference internal" href="spMFCheckAndUpdateAssemblyVersion.html">spMFCheckAndUpdateAssemblyVersion</a></li>
<li class="toctree-l2"><a class="reference internal" href="spMFCheckLicenseStatus.html">spMFCheckLicenseStatus</a></li>
<li class="toctree-l2"><a class="reference internal" href="spMFClassTableColumns.html">spMFClassTableColumns</a></li>
<li class="toctree-l2"><a class="reference internal" href="spMFClassTableStats.html">spMFClassTableStats</a></li>
<li class="toctree-l2"><a class="reference internal" href="spMFConnectionTest.html">spMFconnectionTest</a></li>
<li class="toctree-l2"><a class="reference internal" href="spMFContextMenuActionItem.html">spMFContextMenuActionItem</a></li>
<li class="toctree-l2"><a class="reference internal" href="spMFContextMenuHeadingItem.html">spMFContextMenuHeadingItem</a></li>
<li class="toctree-l2"><a class="reference internal" href="spMFConvertTableToHtml.html">spMFConvertTableToHtml</a></li>
<li class="toctree-l2"><a class="reference internal" href="spMFCreateAllLookups.html">spMFCreateAllLookups</a></li>
<li class="toctree-l2"><a class="reference internal" href="spMFCreateAllMFTables.html">spMFCreateAllMFTables</a></li>
<li class="toctree-l2"><a class="reference internal" href="spMFCreatePublicSharedLink.html">spMFCreatePublicSharedLink</a></li>
<li class="toctree-l2"><a class="reference internal" href="spMFCreateTable.html">spMFCreateTable</a></li>
<li class="toctree-l2"><a class="reference internal" href="spMFCreateValueListLookupView.html">spMFCreateValueListLookupView</a></li>
<li class="toctree-l2"><a class="reference internal" href="spMFCreateWorkflowStateLookupView.html">spMFCreateWorkflowStateLookupView</a></li>
<li class="toctree-l2"><a class="reference internal" href="spMFDeleteAdhocProperty.html">spMFDeleteAdhocProperty</a></li>
<li class="toctree-l2"><a class="reference internal" href="spMFDeleteHistory.html">spMFDeleteHistory</a></li>
<li class="toctree-l2"><a class="reference internal" href="spMFDeleteObject.html">spMFDeleteObject</a></li>
<li class="toctree-l2"><a class="reference internal" href="spMFDeleteObjectList.html">spMFDeleteObjectList</a></li>
<li class="toctree-l2"><a class="reference internal" href="spMFDeleteObjectVersionList.html">spMFDeleteObjectVersionList</a></li>
<li class="toctree-l2"><a class="reference internal" href="spMFDeploymentDetails.html">spMFDeploymentDetails</a></li>
<li class="toctree-l2"><a class="reference internal" href="spMFDropAllClassTables.html">spMFDropAllClassTables</a></li>
<li class="toctree-l2"><a class="reference internal" href="spMFDropAndUpdateMetadata.html">spMFDropAndUpdateMetadata</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">spMFExportFiles</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#purpose">Purpose</a></li>
<li class="toctree-l3"><a class="reference internal" href="#additional-info">Additional Info</a></li>
<li class="toctree-l3"><a class="reference internal" href="#examples">Examples</a></li>
<li class="toctree-l3"><a class="reference internal" href="#changelog">Changelog</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="spMFGetDataExport.html">spMFGetDataExport</a></li>
<li class="toctree-l2"><a class="reference internal" href="spMFGetDeletedObjects.html">spMFGetDeletedObjects</a></li>
<li class="toctree-l2"><a class="reference internal" href="spMFGetFilesDetails.html">spMFGetFilesDetails</a></li>
<li class="toctree-l2"><a class="reference internal" href="spMFGetHistory.html">spMFGetHistory</a></li>
<li class="toctree-l2"><a class="reference internal" href="spMFGetLicense.html">spMFGetLicense</a></li>
<li class="toctree-l2"><a class="reference internal" href="spMFGetMFilesAssemblyVersion.html">spMFGetMFilesAssemblyVersion</a></li>
<li class="toctree-l2"><a class="reference internal" href="spMFGetMfilesLog.html">spMFGetMfilesLog</a></li>
<li class="toctree-l2"><a class="reference internal" href="spMFGetObjectvers.html">spMFGetObjectvers</a></li>
<li class="toctree-l2"><a class="reference internal" href="spMFImportBlobFilesToMFiles.html">spMFImportBlobFilesToMFiles</a></li>
<li class="toctree-l2"><a class="reference internal" href="spMFInsertClass.html">spMFInsertClass</a></li>
<li class="toctree-l2"><a class="reference internal" href="spMFInsertClassProperty.html">spMFInsertClassProperty</a></li>
<li class="toctree-l2"><a class="reference internal" href="spMFInsertLoginAccount.html">spMFInsertLoginAccount</a></li>
<li class="toctree-l2"><a class="reference internal" href="spMFInsertObjectType.html">spMFInsertObjectType</a></li>
<li class="toctree-l2"><a class="reference internal" href="spMFInsertProperty.html">spMFInsertProperty</a></li>
<li class="toctree-l2"><a class="reference internal" href="spMFInsertUserAccount.html">spMFInsertUserAccount</a></li>
<li class="toctree-l2"><a class="reference internal" href="spMFInsertUserMessage.html">spMFInsertUserMessage</a></li>
<li class="toctree-l2"><a class="reference internal" href="spMFInsertValueList.html">spMFInsertValueList</a></li>
<li class="toctree-l2"><a class="reference internal" href="spMFInsertValueListItems.html">spMFInsertValueListItems</a></li>
<li class="toctree-l2"><a class="reference internal" href="spMFInsertWorkflow.html">spMFInsertWorkflow</a></li>
<li class="toctree-l2"><a class="reference internal" href="spMFInsertWorkflowState.html">spMFInsertWorkflowState</a></li>
<li class="toctree-l2"><a class="reference internal" href="spMFLogProcessSummaryForClassTable.html">spMFLogProcessSummaryForClassTable</a></li>
<li class="toctree-l2"><a class="reference internal" href="spMFObjectTypeUpdateClassIndex.html">spMFObjectTypeUpdateClassIndex</a></li>
<li class="toctree-l2"><a class="reference internal" href="spMFProcessBatchDetail_Insert.html">spMFProcessBatchDetail_Insert</a></li>
<li class="toctree-l2"><a class="reference internal" href="spMFProcessBatch_Upsert.html">spMFProcessBatch_Upsert</a></li>
<li class="toctree-l2"><a class="reference internal" href="spMFProcessBatch_mail.html">spMFProcessBatch_Mail</a></li>
<li class="toctree-l2"><a class="reference internal" href="spMFRemoveAdditionalProperties.html">spMFRemoveAdditionalProperties</a></li>
<li class="toctree-l2"><a class="reference internal" href="spMFResultMessageForUI.html">spMFResultMessageForUI</a></li>
<li class="toctree-l2"><a class="reference internal" href="spMFSearchForObject.html">spMFSearchForObject</a></li>
<li class="toctree-l2"><a class="reference internal" href="spMFSearchForObjectbyPropertyValues.html">spMFSearchForObjectbyPropertyValues</a></li>
<li class="toctree-l2"><a class="reference internal" href="spMFSendHTMLBodyEmail.html">spMFSendHTMLBodyEmail</a></li>
<li class="toctree-l2"><a class="reference internal" href="spMFSetUniqueIndexes.html">spMFSetUniqueIndexes</a></li>
<li class="toctree-l2"><a class="reference internal" href="spMFSetup_Reporting.html">spMFSetup_Reporting</a></li>
<li class="toctree-l2"><a class="reference internal" href="spMFSynchronizeClasses.html">spMFSynchronizeClasses</a></li>
<li class="toctree-l2"><a class="reference internal" href="spMFSynchronizeFilesToMFiles.html">spMFSynchronizeFilesToMFiles</a></li>
<li class="toctree-l2"><a class="reference internal" href="spMFSynchronizeLookupColumnChange.html">spmfSynchronizeLookupColumnChange</a></li>
<li class="toctree-l2"><a class="reference internal" href="spMFSynchronizeMetadata.html">spMFSynchronizeMetadata</a></li>
<li class="toctree-l2"><a class="reference internal" href="spMFSynchronizeObjectType.html">spMFSynchronizeObjectType</a></li>
<li class="toctree-l2"><a class="reference internal" href="spMFSynchronizeProperties.html">spMFSynchronizeProperties</a></li>
<li class="toctree-l2"><a class="reference internal" href="spMFSynchronizeSpecificMetadata.html">spMFSynchronizeSpecificMetadata</a></li>
<li class="toctree-l2"><a class="reference internal" href="spMFSynchronizeUserAccount.html">spMFSynchronizeUserAccount</a></li>
<li class="toctree-l2"><a class="reference internal" href="spMFSynchronizeValueList.html">spMFSynchronizeValueList</a></li>
<li class="toctree-l2"><a class="reference internal" href="spMFSynchronizeValueListItems.html">spMFSynchronizeValueListItems</a></li>
<li class="toctree-l2"><a class="reference internal" href="spMFSynchronizeValueListItemsToMfiles.html">spMFSynchronizeValueListItemsToMfiles</a></li>
<li class="toctree-l2"><a class="reference internal" href="spMFSynchronizeWorkFlowStateColumnChange.html">spMFSynchronizeWorkFlowSateColumnChange</a></li>
<li class="toctree-l2"><a class="reference internal" href="spMFSynchronizeWorkflow.html">spMFSynchronizeWorkflow</a></li>
<li class="toctree-l2"><a class="reference internal" href="spMFSynchronizeWorkflowsStates.html">spMFSynchronizeWorkflowsStates</a></li>
<li class="toctree-l2"><a class="reference internal" href="spMFTableAudit.html">spMFTableAudit</a></li>
<li class="toctree-l2"><a class="reference internal" href="spMFUpdateAllncludedInAppTables.html">spMFUpdateAllncludedInAppTables</a></li>
<li class="toctree-l2"><a class="reference internal" href="spMFUpdateAssemblies.html">spMFUpdateAssemblies</a></li>
<li class="toctree-l2"><a class="reference internal" href="spMFUpdateContextMenuQueue.html">spMFUpdateContextMenuQueue</a></li>
<li class="toctree-l2"><a class="reference internal" href="spMFUpdateExplorerFileToMFiles.html">spMFUpdateExplorerFileToMFiles</a></li>
<li class="toctree-l2"><a class="reference internal" href="spMFUpdateHistoryShow.html">spMFUpdateHistoryShow</a></li>
<li class="toctree-l2"><a class="reference internal" href="spMFUpdateItemByItem.html">spMFUpdateItemByItem</a></li>
<li class="toctree-l2"><a class="reference internal" href="spMFUpdateMFilesToMFSQL.html">spMFUpdateMFilesToMFSQL</a></li>
<li class="toctree-l2"><a class="reference internal" href="spMFUpdateObjectChangeHistory.html">spMFUpdateObjectChangeHistory</a></li>
<li class="toctree-l2"><a class="reference internal" href="spMFUpdateSynchronizeError.html">spMFUpdateSynchronizeError</a></li>
<li class="toctree-l2"><a class="reference internal" href="spMFUpdateTable.html">spMFUpdateTable</a></li>
<li class="toctree-l2"><a class="reference internal" href="spMFUpdateTableInternal.html">spMFUpdateTableInternal</a></li>
<li class="toctree-l2"><a class="reference internal" href="spMFUpdateTableWithLastModifiedDate.html">spMFUpdateTableWithLastModifiedDate</a></li>
<li class="toctree-l2"><a class="reference internal" href="spMFUpdateTable_ObjIDs_GetGroupedList.html">spMFUpdateTable_ObjIDs_GetGroupedList</a></li>
<li class="toctree-l2"><a class="reference internal" href="spMFUpdateTable_ObjIDs_Grouped.html">spMFUpdateTable_ObjIDs_Grouped</a></li>
<li class="toctree-l2"><a class="reference internal" href="spMFUpdateTableinBatches.html">spMFUpdateTableinBatches</a></li>
<li class="toctree-l2"><a class="reference internal" href="spMFValidateEmailProfile.html">spMFValidateEmailProfile</a></li>
<li class="toctree-l2"><a class="reference internal" href="spMFVaultConnectionTest.html">spMFVaultConnectionTest</a></li>
<li class="toctree-l2"><a class="reference internal" href="spMFsettingsForDBUpdate.html">spMFsettingsForDBUpdate</a></li>
<li class="toctree-l2"><a class="reference internal" href="spMFsettingsForVaultUpdate.html">spMFsettingsForVaultUpdate</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../tables/index.html">Tables</a></li>
<li class="toctree-l1"><a class="reference internal" href="../functions/index.html">Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../views/index.html">Views</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">MFSQL Connector</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">Procedures</a> &raquo;</li>
        
      <li>spMFExportFiles</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="spmfexportfiles">
<h1>spMFExportFiles<a class="headerlink" href="#spmfexportfiles" title="Permalink to this headline">¶</a></h1>
<dl class="simple">
<dt>Return</dt><dd><p>1 = Success
-1 = Error</p>
</dd>
<dt>Parameters</dt><dd><dl class="simple">
<dt>&#64;TableName nvarchar(128)</dt><dd><ul class="simple">
<li><p>Name of class table</p></li>
</ul>
</dd>
<dt>&#64;PathProperty_L1 nvarchar(128) (optional)</dt><dd><ul class="simple">
<li><p>Default = NULL</p></li>
<li><p>Optional property column for 1st level path.</p></li>
</ul>
</dd>
<dt>&#64;PathProperty_L2 nvarchar(128) (optional)</dt><dd><ul class="simple">
<li><p>Default = NULL</p></li>
<li><p>Optional column for 2nd level path</p></li>
</ul>
</dd>
<dt>&#64;PathProperty_L3 nvarchar(128) (optional)</dt><dd><ul class="simple">
<li><p>Default = NULL</p></li>
<li><p>Optional column for 3rd level path</p></li>
</ul>
</dd>
<dt>&#64;IsDownload bit</dt><dd><ul class="simple">
<li><p>Default = 1 (yes)</p></li>
<li><p>When set to 0 the file data will be updated in the table but the file is not downloaded.</p></li>
</ul>
</dd>
<dt>&#64;IncludeDocID bit (optional)</dt><dd><ul class="simple">
<li><p>Default = 1</p></li>
<li><p>File name include Document id.</p></li>
</ul>
</dd>
<dt>&#64;Process_id int (optional)</dt><dd><ul class="simple">
<li><p>Default = 1</p></li>
<li><p>process Id for records to be included</p></li>
</ul>
</dd>
<dt>&#64;ProcessBatch_ID int (optional, output)</dt><dd><ul class="simple">
<li><p>Default = NULL</p></li>
<li><p>Referencing the ID of the ProcessBatch logging table</p></li>
</ul>
</dd>
<dt>&#64;Debug int (optional)</dt><dd><ul class="simple">
<li><p>Default = 0</p></li>
<li><p>1 = Standard Debug Mode</p></li>
</ul>
</dd>
</dl>
</dd>
</dl>
<div class="section" id="purpose">
<h2>Purpose<a class="headerlink" href="#purpose" title="Permalink to this headline">¶</a></h2>
<p>The procedure is used to export selected files for class records from M-Files to a designated explorer folder on the server.</p>
</div>
<div class="section" id="additional-info">
<h2>Additional Info<a class="headerlink" href="#additional-info" title="Permalink to this headline">¶</a></h2>
<p>The main use case for this procedure is to allow access to the files as attachments to emails or other third party system applications. An example is to prepare for bulk emailing of customer invoices.</p>
<p>All Object Types with Files can be included in an export.  Each class export is performed separately.</p>
<dl class="simple">
<dt>The destination folder in explorer is defined as:</dt><dd><ul class="simple">
<li><p>The Root folder or UNC path is defined in MFSettings with name “RootFolder”.  The user executing the script must have permission the read and write to this folder.  On installation this folder is automatically set to c:\MFSQL\FileExport.</p></li>
<li><p>The next layer defines the root folder for the class.  This folder is defined in MFClass by changing the value of the column “FileExportFolder” for the specific class in MFClass. This layer is to set the ‘What is being exported’ e.g. SalesInvoices.  If the value in “FileExportFolder” for the class is null then the files will be saved to the root folder.</p></li>
<li><p>Three layers of property related folders can be defined as parameters by setting the PathPropertyL1 to L3 to valid columns on the class table.  These parameters are all optional.  L1 must have a value for L2 to and L3 to be specified.</p></li>
<li><p>Multi document objects will show the name of the object as the name of the folder for the files in the multi file object.</p></li>
<li><p>Filename (with or without object id)</p></li>
</ul>
</dd>
<dt>For example the folders will be</dt><dd><ul class="simple">
<li><p>D:\MFSQLExport\SalesInvoices\ABC Engineering\Service Invoices\2009\ABC Engineering Inv 2324\INV2345.pdf</p></li>
<li><p>D:\MFSQLExport\SalesInvoices\ABC Engineering\Service Invoices\2009\ABC Engineering Inv 2324\Supplements.pdf</p></li>
</ul>
</dd>
<dt>The folder Definition comes from</dt><dd><ul class="simple">
<li><p>Root = D:MFSQLExport (defined in MFSettings)</p></li>
<li><p>Class = SalesInvoices (Defined in MFclass)</p></li>
<li><p>Property 1 = Customer</p></li>
<li><p>Property 2 = Document_type (type of invoice)</p></li>
<li><p>Property 3 = Financial_year (Property showing financial year)</p></li>
<li><p>MultiFile Object = Name_or_title</p></li>
<li><p>Filename with object id</p></li>
</ul>
</dd>
</dl>
<p>Each Path Property is the column values for the object. Level 3 is nested in Level 2 is nested in Level 1. E.g. CustomerABCProjectABCInvoiceMonth.</p>
<p>The security context of the export functionality is using the SQL Service Account. The SQL Service Account must have appropriate permissions to create folders and files on the Root Folder.  Special care should be taken If a UNC path is used to set the SQL Service Account with appropriate permissions to access the UNC path.</p>
<dl class="simple">
<dt>MFExportFileHistory show the export result. Join this table on the class and objid with the class table to relate the files with the metadata.  Additional file data in the MFExportFileHistory table include:</dt><dd><ul class="simple">
<li><p>checksum</p></li>
<li><p>File size</p></li>
<li><p>File Extension</p></li>
<li><p>File ID</p></li>
<li><p>Count of files in object</p></li>
<li><p>Name or title of object for multiple files</p></li>
<li><p>Date lastupdated</p></li>
<li><p>Export Result</p></li>
</ul>
</dd>
</dl>
<p>If IsDownload is set to 0 then the details of the file will be updated in the MFExportFileHistory table will be updated but the file will not be downloaded.</p>
</div>
<div class="section" id="examples">
<h2>Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h2>
<p>Extract of all sales invoices by customer.</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">UPDATE</span>  <span class="p">[</span><span class="n">MFClass</span><span class="p">]</span> <span class="k">SET</span>   <span class="p">[</span><span class="n">FileExportFolder</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;SalesInvoices&#39;</span> <span class="k">WHERE</span>  <span class="p">[</span><span class="n">ID</span><span class="p">]</span> <span class="o">=</span> <span class="mi">36</span><span class="p">;</span>
<span class="k">EXEC</span> <span class="p">[</span><span class="n">spMFCreateTable</span><span class="p">]</span> <span class="s1">&#39;Sales Invoice&#39;</span><span class="p">;</span>
<span class="k">EXEC</span> <span class="p">[</span><span class="n">spMFUpdateTable</span><span class="p">]</span> <span class="s1">&#39;MFSalesInvoice&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">;</span>
<span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span>  <span class="p">[</span><span class="n">mfsalesinvoice</span><span class="p">];</span>
<span class="k">UPDATE</span> <span class="p">[</span><span class="n">mfsalesinvoice</span><span class="p">]</span>
<span class="k">SET</span>    <span class="p">[</span><span class="n">process_id</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="k">WHERE</span>  <span class="p">[</span><span class="n">filecount</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span>
<span class="k">EXEC</span> <span class="p">[</span><span class="n">spMFExportFiles</span><span class="p">]</span>
    <span class="s1">&#39;mfsalesinvoice&#39;</span><span class="p">,</span> <span class="s1">&#39;Customer&#39;</span><span class="p">,</span> <span class="k">NULL</span><span class="p">,</span> <span class="k">NULL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">;</span>
</pre></div>
</div>
<hr class="docutils" />
<p>Produce extract of all sales invoices by Customer by Month (assuming that the invoice Month is a property on the invoice)</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">DECLARE</span> <span class="o">@</span><span class="n">ProcessBatch_ID</span> <span class="nb">INT</span><span class="p">;</span>
<span class="k">EXEC</span> <span class="p">[</span><span class="n">dbo</span><span class="p">].[</span><span class="n">spMFExportFiles</span><span class="p">]</span> <span class="o">@</span><span class="n">TableName</span> <span class="o">=</span> <span class="s1">&#39;MFSalesInvoice&#39;</span><span class="p">,</span>
                             <span class="o">@</span><span class="n">PathProperty_L1</span> <span class="o">=</span> <span class="s1">&#39;Customer&#39;</span><span class="p">,</span>
                             <span class="o">@</span><span class="n">PathProperty_L2</span> <span class="o">=</span> <span class="s1">&#39;Document_Date&#39;</span><span class="p">,</span>
                             <span class="o">@</span><span class="n">PathProperty_L3</span> <span class="o">=</span> <span class="k">null</span><span class="p">,</span>
                             <span class="o">@</span><span class="n">isDownload</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
                             <span class="o">@</span><span class="n">IncludeDocID</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
                             <span class="o">@</span><span class="n">Process_id</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
                             <span class="o">@</span><span class="n">ProcessBatch_ID</span> <span class="o">=</span> <span class="o">@</span><span class="n">ProcessBatch_ID</span> <span class="k">OUTPUT</span><span class="p">,</span>
                             <span class="o">@</span><span class="n">Debug</span> <span class="o">=</span> <span class="mi">0</span>
</pre></div>
</div>
</div>
<div class="section" id="changelog">
<h2>Changelog<a class="headerlink" href="#changelog" title="Permalink to this headline">¶</a></h2>
<table class="docutils align-default">
<colgroup>
<col style="width: 13%" />
<col style="width: 12%" />
<col style="width: 75%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>Date</p></td>
<td><p>Author</p></td>
<td><p>Description</p></td>
</tr>
<tr class="row-even"><td><p>2021-01-07</p></td>
<td><p>LC</p></td>
<td><p>Change CLR to improve downloading multiple files</p></td>
</tr>
<tr class="row-odd"><td><p>2021-01-07</p></td>
<td><p>LC</p></td>
<td><p>Include parameter to restrict download of files</p></td>
</tr>
<tr class="row-even"><td><p>2021-01-05</p></td>
<td><p>LC</p></td>
<td><p>Improve productivity and processing logic</p></td>
</tr>
<tr class="row-odd"><td><p>2021-01-04</p></td>
<td><p>LC</p></td>
<td><p>Add columns filesize and file extension</p></td>
</tr>
<tr class="row-even"><td><p>2021-01-04</p></td>
<td><p>LC</p></td>
<td><p>Add new param for GetFiles and set default to 0</p></td>
</tr>
<tr class="row-odd"><td><p>2020-11-01</p></td>
<td><p>LC</p></td>
<td><p>Fix bug with misplaced as in code</p></td>
</tr>
<tr class="row-even"><td><p>2020-08-22</p></td>
<td><p>LC</p></td>
<td><p>Update code for deleted column change</p></td>
</tr>
<tr class="row-odd"><td><p>2020-05-26</p></td>
<td><p>LC</p></td>
<td><p>Update fileid into table</p></td>
</tr>
<tr class="row-even"><td><p>2019-08-30</p></td>
<td><p>JC</p></td>
<td><p>Added documentation</p></td>
</tr>
<tr class="row-odd"><td><p>2018-12-03</p></td>
<td><p>LC</p></td>
<td><p>Bug ‘String or binary data truncated’ in file name</p></td>
</tr>
<tr class="row-even"><td><p>2018-06-28</p></td>
<td><p>LC</p></td>
<td><p>Set return success = 1</p></td>
</tr>
<tr class="row-odd"><td><p>2018-02-20</p></td>
<td><p>LC</p></td>
<td><p>Set processbatch_id to output</p></td>
</tr>
</tbody>
</table>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="spMFGetDataExport.html" class="btn btn-neutral float-right" title="spMFGetDataExport" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="spMFDropAndUpdateMetadata.html" class="btn btn-neutral float-left" title="spMFDropAndUpdateMetadata" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Laminin Solutions Ltd

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>