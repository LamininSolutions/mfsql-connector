<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Insert new records from SQL &mdash; MFSQL Connector 4.11.33.77 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=19f00094" />

  
    <link rel="shortcut icon" href="../../_static/MFSQL-Favicon.ico"/>
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../_static/documentation_options.js?v=24c0f75b"></script>
        <script src="../../_static/doctools.js?v=888ff710"></script>
        <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Integration for vendor approval" href="../integration-vendor-approval/index.html" />
    <link rel="prev" title="Example procedure for importing sales invoices on demand" href="../importing-files-from-explorer/import-file-example/index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            MFSQL Connector
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">FAQ:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../faq/index.html">Frequently asked questions</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">MFSQL Connector Guide:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../introduction/index.html">Introduction to MFSQL</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../getting-started/index.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../mfsql-data-exchange-and-reporting-connector/index.html">MFSQL Data Exchange and reporting Connector</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../mfsql-integration-connector/index.html">MFSQL Integration Connector</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../the-connector-framework/index.html">The Connector Framework</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../version-control/index.html">Version Control</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Blog:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">List of blogs</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../advanced-updating-of-valuelists-from-external-source/index.html">Advanced updating of Valuelists from external source</a></li>
<li class="toctree-l2"><a class="reference internal" href="../align-metadata-from-an-external-source-with-data-in-m-files/index.html">Align metadata from an external source with data in M-Files</a></li>
<li class="toctree-l2"><a class="reference internal" href="../aligning-valuelist-items-with-different-owners/index.html">Aligning valuelist items with different owners</a></li>
<li class="toctree-l2"><a class="reference internal" href="../background-action-on-workflow-change/index.html">Perform a background operation in SQL on workflow change</a></li>
<li class="toctree-l2"><a class="reference internal" href="../building-applications-around-m-files/index.html">Building applications around M-Files</a></li>
<li class="toctree-l2"><a class="reference internal" href="../certified-application-developer-presentation/index.html">Certified Application Developer presentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changing-class-of-object/index.html">Changing the class of an object</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changing-from-single-lookup-to-multi-lookup/index.html">Changing from single lookup to multi lookup</a></li>
<li class="toctree-l2"><a class="reference internal" href="../considerations-for-deleted-records/index.html">Considerations for deleted records</a></li>
<li class="toctree-l2"><a class="reference internal" href="../considerations-for-large-volume-vault/index.html">Considerations for large volume vault</a></li>
<li class="toctree-l2"><a class="reference internal" href="../create-a-scheduled-pull-from-m-files-using-sql-server-agent/index.html">Create a scheduled pull from M-Files using SQL Server Agent</a></li>
<li class="toctree-l2"><a class="reference internal" href="../creating-and-using-public-shared-link/index.html">Creating and using public shared link</a></li>
<li class="toctree-l2"><a class="reference internal" href="../creating-multiple-related-objects-on-file-import/index.html">Creating multiple related objects on file import</a></li>
<li class="toctree-l2"><a class="reference internal" href="../crm-and-emailer-management/index.html">CRM and Emailer Management</a></li>
<li class="toctree-l2"><a class="reference internal" href="../deleting-duplicate-objects/index.html">Deleting duplicate objects</a></li>
<li class="toctree-l2"><a class="reference internal" href="../export-files-from-vault/index.html">Exporting files from a vault</a></li>
<li class="toctree-l2"><a class="reference internal" href="../externalid-displayid-objid/index.html">ExternalID versus DisplayID versus Objid</a></li>
<li class="toctree-l2"><a class="reference internal" href="../get-all-objects-in-vault/index.html">Explore all the objects in the vault</a></li>
<li class="toctree-l2"><a class="reference internal" href="../get-number-of-records-in-class/index.html">Get number of records in Class</a></li>
<li class="toctree-l2"><a class="reference internal" href="../get-objectchangehistory/index.html">Working with object change history</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting-started-with-a-custom-application/index.html">Getting started with a custom application</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting-to-know-mfsql-connector/index.html">Getting to know MFSQL Connector</a></li>
<li class="toctree-l2"><a class="reference internal" href="../howto-quick-follow-up-list/index.html">How to generate a quick follow up list</a></li>
<li class="toctree-l2"><a class="reference internal" href="../illegal-xml-characters/index.html">Illegal XML Characters</a></li>
<li class="toctree-l2"><a class="reference internal" href="../importing-files-from-explorer/index.html">Importing files into M-Files</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Insert new records from SQL</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#designing-the-target-class">Designing the target class</a></li>
<li class="toctree-l3"><a class="reference internal" href="#update-the-metadata-structure">Update the metadata structure</a></li>
<li class="toctree-l3"><a class="reference internal" href="#create-the-class-table">Create the class table</a></li>
<li class="toctree-l3"><a class="reference internal" href="#create-script-procedure-to-insert-new-records">Create script / procedure to insert new records.</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#aliases">Aliases</a></li>
<li class="toctree-l4"><a class="reference internal" href="#valuelist-lookups">Valuelist lookups</a></li>
<li class="toctree-l4"><a class="reference internal" href="#workflow-lookups">Workflow lookups</a></li>
<li class="toctree-l4"><a class="reference internal" href="#update-valuelist-items">Update valuelist items</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#update-records-from-sql-to-m-files">Update records from SQL to M-Files</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../integration-vendor-approval/index.html">Integration for vendor approval</a></li>
<li class="toctree-l2"><a class="reference internal" href="../integration-whitepaper/index.html">Integration whitepaper</a></li>
<li class="toctree-l2"><a class="reference internal" href="../integration-with-sage-200---case-management/index.html">Integration with SAGE 200 - Case Management</a></li>
<li class="toctree-l2"><a class="reference internal" href="../integration-with-sage-50/index.html">Integration with SAGE 50</a></li>
<li class="toctree-l2"><a class="reference internal" href="../integration-with-test-equipment/index.html">Integration with test equipment</a></li>
<li class="toctree-l2"><a class="reference internal" href="../integration-with-vendor-management-and-purchasing-with-epicor-enterprise/index.html">Integration with Vendor Management and Purchasing with Epicor Enterprise</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mark-for-archiving-using-class-table/index.html">Mark for Archiving using Class Table</a></li>
<li class="toctree-l2"><a class="reference internal" href="../metadata-management/index.html">Metadata Management and data cleansing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../metadata_management_and_realignment/index.html">Metadata Management and Realignment Case Study</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mf-last-modified-user-in-action/index.html">MF-Last-Modified-User in action</a></li>
<li class="toctree-l2"><a class="reference internal" href="../moving-documents-from-one-class-to-another/index.html">Moving documents from one class to another</a></li>
<li class="toctree-l2"><a class="reference internal" href="../moving-metadata-from-text-properties-to-valuelist-items/index.html">Moving metadata from text properties to Valuelist items</a></li>
<li class="toctree-l2"><a class="reference internal" href="../multiselectlookups/index.html">MultiSelectLookups</a></li>
<li class="toctree-l2"><a class="reference internal" href="../near-real-time-reporting/index.html">Near real time reporting</a></li>
<li class="toctree-l2"><a class="reference internal" href="../online-ordering-of-special-stock/index.html">Online Ordering of special stock</a></li>
<li class="toctree-l2"><a class="reference internal" href="../online-quote-system/index.html">Online Quote System</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practical_use_of_logging/index.html">Practical use of logging in Procedures</a></li>
<li class="toctree-l2"><a class="reference internal" href="../processing-scanned-documents/index.html">Processing scanned documents</a></li>
<li class="toctree-l2"><a class="reference internal" href="../properties-with-multi-lookup-datatypes/index.html">Properties with multi lookup datatypes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../real-datatype/index.html">Limitations of real datatype</a></li>
<li class="toctree-l2"><a class="reference internal" href="../report-designers-and-the-connector/index.html">Report designers and the Connector</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reports-from-the-extended-event-log/index.html">Reports from the extended Event log</a></li>
<li class="toctree-l2"><a class="reference internal" href="../restore-to-a-different-database/index.html">Restore MFSQL database to a different server</a></li>
<li class="toctree-l2"><a class="reference internal" href="../rpc-over-https/index.html">RPC over HTTPS setup</a></li>
<li class="toctree-l2"><a class="reference internal" href="../setting-up-a-workflow-state-change/index.html">Setting up a workflow state change</a></li>
<li class="toctree-l2"><a class="reference internal" href="../setup-agent-proxy/index.html">Setup Agent Proxy for MFSQLConnect</a></li>
<li class="toctree-l2"><a class="reference internal" href="../status-report-using-context-menu/index.html">Status report using context menu</a></li>
<li class="toctree-l2"><a class="reference internal" href="../table-relations---views-for-reporting/index.html">Table relations - views for reporting</a></li>
<li class="toctree-l2"><a class="reference internal" href="../update-large-tables/index.html">Update large tables using batch mode</a></li>
<li class="toctree-l2"><a class="reference internal" href="../update-to-VAF-4-10/index.html">Upgrading to VAF 10.4</a></li>
<li class="toctree-l2"><a class="reference internal" href="../updating-a-multi-lookup-property-on-an-object/index.html">Updating a multi lookup property on an object</a></li>
<li class="toctree-l2"><a class="reference internal" href="../updating-incorrect-properties-across-multiple-related-classes/index.html">Updating incorrect properties across multiple related classes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../updating-only-records-that-changed/index.html">Updating only records that changed</a></li>
<li class="toctree-l2"><a class="reference internal" href="../updating_millions_of_records/index.html">Updating millions of records</a></li>
<li class="toctree-l2"><a class="reference internal" href="../using-delimiter-functions/index.html">Using delimiter functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../using-event-handler-for-sql-action/index.html">Using event handler for SQL action</a></li>
<li class="toctree-l2"><a class="reference internal" href="../using-hyperlinks-with-mfsql-connector/index.html">Using hyperlinks with MFSQL Connector</a></li>
<li class="toctree-l2"><a class="reference internal" href="../using-m-files-external-connector/index.html">Using M-Files External Connector</a></li>
<li class="toctree-l2"><a class="reference internal" href="../using-spmfclasstablestats/index.html">Using spMFClassTableStats</a></li>
<li class="toctree-l2"><a class="reference internal" href="../using-the-external_id-to-match-third-party-app-tables/index.html">Using the External_ID to match third party app tables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../windows-authentication/index.html">Using windows authentication</a></li>
<li class="toctree-l2"><a class="reference internal" href="../working_with_checkedout/index.html">Working with checkedOut objects</a></li>
<li class="toctree-l2"><a class="reference internal" href="../working_with_dates/index.html">Working with date and time</a></li>
<li class="toctree-l2"><a class="reference internal" href="../working_with_document_collections/index.html">Working with Document Collections</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">SQL Components:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../procedures/index.html">Procedures</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tables/index.html">Tables</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../functions/index.html">Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../views/index.html">Views</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../triggers/index.html">Triggers</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">MFSQL Connector</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">List of blogs</a></li>
      <li class="breadcrumb-item active">Insert new records from SQL</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="insert-new-records-from-sql">
<h1>Insert new records from SQL<a class="headerlink" href="#insert-new-records-from-sql" title="Link to this heading"></a></h1>
<p>MFSQL Connector allows for new records to be added from SQL to M-Files.
This blog illustrates some of the key considerations and methods
associated with inserting new records.</p>
<p>The key steps in adding records from SQL include:</p>
<ol class="arabic simple">
<li><p>Design the target class object in M-Files with all the required
properties.</p></li>
<li><p>Update the metadata structure in SQL</p></li>
<li><p>Create the class table</p></li>
<li><p>Create script/procedure to insert records into the class table</p></li>
<li><p>Update from SQL to M-Files</p></li>
</ol>
<section id="designing-the-target-class">
<h2>Designing the target class<a class="headerlink" href="#designing-the-target-class" title="Link to this heading"></a></h2>
<p>When designing the target class the following should be considered:</p>
<ul class="simple">
<li><p>Using M-Files scripting or auto calculated properties to calculate
values for properties is allowed. In some cases it is advisable to
perform the calculation in SQL. See below for dealing with auto
calculated properties in the SQL insert.</p></li>
<li><p>Adding a file and metadata is possible. There are several methods to
achieve this. See separate blog for working with files.</p></li>
<li><p>It is good practice to use single lookup properties when only single
lookup should be used. M-Files creates new Object Type and Valuelist
properties by default as multi lookups. Working with multi lookups in
SQL has different considerations. See the separate blogs on working
with multi - lookups.</p></li>
<li><p>Scripting and compliance kit rules which operates on class could slow
down the performance of updating records from SQL to M-Files.</p></li>
</ul>
</section>
<section id="update-the-metadata-structure">
<h2>Update the metadata structure<a class="headerlink" href="#update-the-metadata-structure" title="Link to this heading"></a></h2>
<p>Always update the metadata structure in the Connector after making
changes in M-Files. Use the short form of the procedure. It should deal
with most scenarios of update. Only use the optional parameters if there
is a specific reason for it.</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">EXEC</span><span class="w"> </span><span class="p">[</span><span class="n">dbo</span><span class="p">].[</span><span class="n">spMFDropAndUpdateMetadata</span><span class="p">]</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Use the utilities to get a better handle on the metadata structure
and errors.</p></li>
</ul>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="c1">--review which tables are already included in the app</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">includeinApp</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="p">[</span><span class="n">dbo</span><span class="p">].[</span><span class="n">MFClass</span><span class="p">]</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="p">[</span><span class="n">mc</span><span class="p">]</span>

<span class="c1">--review all the properties for a specific class</span>
<span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span>
<span class="w"> </span><span class="k">FROM</span><span class="w">   </span><span class="p">[</span><span class="n">MFvwMetadataStructure</span><span class="p">]</span>
<span class="w"> </span><span class="k">WHERE</span><span class="w">  </span><span class="p">[</span><span class="k">class</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;Customer&#39;</span><span class="w"> </span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">Property_MFID</span>

<span class="c1">--review all the classes for a specific property</span>
<span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="k">class</span><span class="p">,</span><span class="o">*</span>
<span class="w"> </span><span class="k">FROM</span><span class="w">   </span><span class="p">[</span><span class="n">MFvwMetadataStructure</span><span class="p">]</span>
<span class="w"> </span><span class="k">WHERE</span><span class="w">  </span><span class="p">[</span><span class="n">Property</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;Customer&#39;</span><span class="w"> </span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">class_MFID</span>

<span class="w"> </span><span class="c1">--review property and column usage and comparisons</span>
<span class="k">EXEC</span><span class="w"> </span><span class="p">[</span><span class="n">dbo</span><span class="p">].[</span><span class="n">spMFClassTableColumns</span><span class="p">]</span>
<span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="o">##</span><span class="n">spMFClassTableColumns</span>
</pre></div>
</div>
</section>
<section id="create-the-class-table">
<h2>Create the class table<a class="headerlink" href="#create-the-class-table" title="Link to this heading"></a></h2>
<p>If not already in existence, then create the class table</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">EXEC</span><span class="w"> </span><span class="p">[</span><span class="n">spMFCreateTable</span><span class="p">]</span><span class="w"> </span><span class="s1">&#39;Customer&#39;</span>
<span class="c1">--or</span>
<span class="k">EXEC</span><span class="w"> </span><span class="p">[</span><span class="n">spMFCreateTable</span><span class="p">]</span><span class="w"> </span><span class="o">@</span><span class="n">className</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;Customer&#39;</span>
</pre></div>
</div>
<p>It is a good practice to drop and recreate if the table exists and many
structural changes was made</p>
<p>When creating a new class table the MFClass table is automatically
updated with ‘includeinApp’ column to 1</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="n">includeinApp</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="p">[</span><span class="n">dbo</span><span class="p">].[</span><span class="n">MFClass</span><span class="p">]</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="p">[</span><span class="n">mc</span><span class="p">]</span>
</pre></div>
</div>
<p>Use the utilities to speed up the design process.</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="c1">--CREATE ALL CLASS TABLES WITH INCLUDED IN APP 1 OR 2 IN ONE GO</span>
<span class="w"> </span><span class="k">EXEC</span><span class="w"> </span><span class="p">[</span><span class="n">spMFCreateAllMFTables</span><span class="p">]</span>

<span class="c1">--DROP ALL CLASS TABLES WITH A SPECIFIC INCLUDED IN APP</span>
<span class="w"> </span><span class="k">EXEC</span><span class="w"> </span><span class="p">[</span><span class="n">spMFDropAllClassTables</span><span class="p">]</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="c1">-- does not reset included in app to allow for recreation</span>
<span class="c1">--or</span>
<span class="w"> </span><span class="k">EXEC</span><span class="w"> </span><span class="p">[</span><span class="n">spMFDropAllClassTables</span><span class="p">]</span><span class="w"> </span><span class="o">@</span><span class="n">IncludeinApp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>

<span class="c1">--UPDATE RECORDS FOR ALL CLASS TABLED WITH INCLUDEINAPP = 1</span>
<span class="w"> </span><span class="k">EXEC</span><span class="w"> </span><span class="p">[</span><span class="n">spMFUpdateAllncludedInAppTables</span><span class="p">]</span><span class="w"> </span><span class="mi">1</span>
<span class="c1">--or</span>
<span class="w"> </span><span class="k">EXEC</span><span class="w"> </span><span class="p">[</span><span class="n">spMFUpdateAllncludedInAppTables</span><span class="p">]</span><span class="w"> </span><span class="o">@</span><span class="n">UpdateMethod</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
</pre></div>
</div>
</section>
<section id="create-script-procedure-to-insert-new-records">
<h2>Create script / procedure to insert new records.<a class="headerlink" href="#create-script-procedure-to-insert-new-records" title="Link to this heading"></a></h2>
<p>Create an insert statement to the class table to add new records.
Consider the following</p>
<ul>
<li><p>Always set process_id = 1. this will allow the update procedure to
identify the need for a SQL to M-Files operation.</p></li>
<li><p>Ignore the following columns. These columns are all managed by the
Connector.</p>
<ul>
<li><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">GUID</span><span class="p">],[</span><span class="n">MX_User_ID</span><span class="p">],[</span><span class="k">Class</span><span class="p">],[</span><span class="n">Class_ID</span><span class="p">],[</span><span class="n">Created</span><span class="p">],[</span><span class="n">Created_by</span><span class="p">],[</span><span class="n">Created_by_ID</span><span class="p">]</span>
<span class="p">,[</span><span class="n">MF_Last_Modified</span><span class="p">],[</span><span class="n">MF_Last_Modified_by</span><span class="p">],[</span><span class="n">MF_Last_Modified_by_ID</span><span class="p">]</span>
<span class="p">,[</span><span class="n">Single_File</span><span class="p">],[</span><span class="n">LastModified</span><span class="p">],[</span><span class="n">ObjID</span><span class="p">],[</span><span class="n">ExternalID</span><span class="p">],[</span><span class="n">MFVersion</span><span class="p">]</span>
<span class="p">,[</span><span class="n">FileCount</span><span class="p">],[</span><span class="n">Deleted</span><span class="p">],[</span><span class="n">Update_ID</span><span class="p">]</span>
</pre></div>
</div>
</li>
</ul>
</li>
<li><p>Optionally use the following</p>
<ul class="simple">
<li><p>Use ExternalID to add a unique reference of an external system.</p></li>
<li><p>MX_User_ID to add reference to an external user (not included in
M-Files</p></li>
<li><p>MX_any_column_name to add columns to be ignored by updates to
M-Files</p></li>
</ul>
</li>
<li><p>Lookup columns (columns with _ID at the end.</p>
<ul class="simple">
<li><p>Get MFID or Objid for the related object. Comma delimit
multi-lookup values</p></li>
<li><p>Ignore the label columns for lookups.</p></li>
<li><p>See separate blog for working with multi-lookups</p></li>
</ul>
</li>
<li><p>Required</p>
<ul class="simple">
<li><p>Phantom value for all properties with a auto calculation in
M-Files (scripting or Compliance kit based)</p></li>
<li><p>Phantom value for all properties that are used in calculated
values in M-Files</p></li>
<li><p>Values for all required properties in M-Files. Use
<code class="docutils literal notranslate"><span class="pre">##spMFClassTableColumns</span></code> to assess</p></li>
</ul>
</li>
</ul>
<p>Use utilities to support pre-processes for working with aliases,
valuelists and workflows</p>
<section id="aliases">
<h3>Aliases<a class="headerlink" href="#aliases" title="Link to this heading"></a></h3>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="c1">--Update alias. (for classes, properties, valuelists, valuelist items, workflows and workflow states)</span>

<span class="k">UPDATE</span><span class="w"> </span><span class="p">[</span><span class="n">MFClass</span><span class="p">]</span>
<span class="k">SET</span><span class="w"> </span><span class="p">[</span><span class="k">Alias</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;c.customer&#39;</span>
<span class="k">WHERE</span><span class="w"> </span><span class="p">[</span><span class="n">Name</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;Customer&#39;</span><span class="p">;</span>

<span class="c1">--Process Table changes</span>
<span class="k">EXEC</span><span class="w"> </span><span class="p">[</span><span class="n">spMFSynchronizeSpecificMetadata</span><span class="p">]</span><span class="w"> </span><span class="o">@</span><span class="n">Metadata</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;Class&#39;</span>
<span class="w">                                      </span><span class="p">,</span><span class="o">@</span><span class="n">IsUpdate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="k">EXEC</span><span class="w"> </span><span class="p">[</span><span class="n">spMFSynchronizeSpecificMetadata</span><span class="p">]</span><span class="w"> </span><span class="o">@</span><span class="n">Metadata</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;Class&#39;</span><span class="p">,</span><span class="w"> </span><span class="o">@</span><span class="n">IsUpdate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>

<span class="c1">--bulk update aliases</span>
<span class="k">EXEC</span><span class="w"> </span><span class="p">[</span><span class="n">dbo</span><span class="p">].[</span><span class="n">spMFAliasesUpsert</span><span class="p">]</span>
<span class="w">    </span><span class="o">@</span><span class="n">MFTableNames</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;MFProperty&#39;</span><span class="p">,</span><span class="w"> </span><span class="c1">-- comma delimited string</span>
<span class="w">    </span><span class="o">@</span><span class="k">Prefix</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;prop&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="o">@</span><span class="n">IsRemove</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
<span class="w">    </span><span class="o">@</span><span class="n">WithUpdate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>

<span class="c1">--Removing all aliases with a prefix of ws from workflow states</span>
<span class="k">EXEC</span><span class="w"> </span><span class="p">[</span><span class="n">dbo</span><span class="p">].[</span><span class="n">spMFAliasesUpsert</span><span class="p">]</span>
<span class="w">    </span><span class="o">@</span><span class="n">MFTableNames</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;MFWorkflowstate&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="o">@</span><span class="k">Prefix</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;ws&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="o">@</span><span class="n">IsRemove</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="c1">-- set to 1 to remove all aliases</span>
<span class="w">    </span><span class="o">@</span><span class="n">WithUpdate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
</pre></div>
</div>
</section>
<section id="valuelist-lookups">
<h3>Valuelist lookups<a class="headerlink" href="#valuelist-lookups" title="Link to this heading"></a></h3>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="c1">-- create valuelist lookups</span>
<span class="k">EXEC</span><span class="w"> </span><span class="p">[</span><span class="n">dbo</span><span class="p">].[</span><span class="n">spMFCreateValueListLookupView</span><span class="p">]</span><span class="w"> </span><span class="o">@</span><span class="n">ValueListName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;Country&#39;</span><span class="w"> </span><span class="c1">-- nvarchar(128)</span>
<span class="w">                                          </span><span class="p">,</span><span class="o">@</span><span class="n">ViewName</span><span class="w"> </span><span class="o">=</span><span class="w">  </span><span class="s1">&#39;MFvwCountry&#39;</span><span class="w">     </span><span class="c1">-- nvarchar(128)</span>
<span class="w">                                          </span><span class="p">,</span><span class="o">@</span><span class="k">Schema</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;Custom&#39;</span><span class="w">        </span><span class="c1">-- nvarchar(20)</span>

<span class="k">SELECT</span><span class="w"> </span><span class="o">*</span>
<span class="k">FROM</span><span class="w">   </span><span class="n">custom</span><span class="p">.[</span><span class="n">MFvwCountry</span><span class="p">]</span>
</pre></div>
</div>
</section>
<section id="workflow-lookups">
<h3>Workflow lookups<a class="headerlink" href="#workflow-lookups" title="Link to this heading"></a></h3>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="c1">--Create workflow views</span>
<span class="w"> </span><span class="k">EXEC</span><span class="w"> </span><span class="p">[</span><span class="n">spMFCreateWorkflowStateLookupView</span><span class="p">]</span><span class="w"> </span><span class="s1">&#39;Contract Approval Workflow&#39;</span>
<span class="w">            </span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;MFvwContractApproval&#39;</span>

<span class="c1">--or</span>

<span class="k">EXEC</span><span class="w"> </span><span class="p">[</span><span class="n">dbo</span><span class="p">].[</span><span class="n">spMFCreateWorkflowStateLookupView</span><span class="p">]</span><span class="w"> </span><span class="o">@</span><span class="n">WorkflowName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;Contract Approval Workflow&#39;</span><span class="w"> </span><span class="c1">-- nvarchar(128)</span>
<span class="w">                                              </span><span class="p">,</span><span class="o">@</span><span class="n">ViewName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;MFvwContractApproval&#39;</span><span class="w">     </span><span class="c1">-- nvarchar(128)</span>
<span class="w">                                              </span><span class="p">,</span><span class="o">@</span><span class="k">Schema</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;Custom&#39;</span><span class="w">       </span><span class="c1">-- nvarchar(20)</span>

<span class="k">SELECT</span><span class="w"> </span><span class="o">*</span>
<span class="k">FROM</span><span class="w">   </span><span class="p">[</span><span class="n">MFvwContractApproval</span><span class="p">]</span>
</pre></div>
</div>
</section>
<section id="update-valuelist-items">
<h3>Update valuelist items<a class="headerlink" href="#update-valuelist-items" title="Link to this heading"></a></h3>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="c1">--Add new valuelist item</span>


<span class="c1">--CHANGING THE NAME OF VALUELIST ITEM (name, DisplayID)</span>

<span class="w"> </span><span class="k">UPDATE</span><span class="w"> </span><span class="p">[</span><span class="n">mvli</span><span class="p">]</span>
<span class="w"> </span><span class="k">SET</span><span class="w">    </span><span class="p">[</span><span class="n">Process_ID</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
<span class="w">   </span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="n">mvli</span><span class="p">].[</span><span class="n">Name</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;United Kingdom&#39;</span>
<span class="w">   </span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="n">DisplayID</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;3&#39;</span>
<span class="w"> </span><span class="c1">--select vc.*</span>
<span class="w"> </span><span class="k">FROM</span><span class="w">   </span><span class="p">[</span><span class="n">MFValuelistitems</span><span class="p">]</span><span class="w"> </span><span class="p">[</span><span class="n">mvli</span><span class="p">]</span>
<span class="c1">-- INNER JOIN [vwMFCountry] [vc] ON [vc].[AppRef_ValueListItems] = [mvli].[appref]</span>
<span class="w"> </span><span class="k">WHERE</span><span class="w">  </span><span class="p">[</span><span class="n">mvli</span><span class="p">].[</span><span class="n">AppRef</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;2#154#3&#39;</span>

<span class="c1">--INSERT NEW VALUE LIST ITEM (note only name process_id and valuelist id is required)</span>
<span class="c1">--display_id must be unique, if not set it will default to the mfid</span>

<span class="w"> </span><span class="k">DECLARE</span><span class="w"> </span><span class="o">@</span><span class="n">Valuelist_ID</span><span class="w"> </span><span class="nb">INT</span>
<span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="o">@</span><span class="n">Valuelist_ID</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">id</span><span class="p">]</span>
<span class="w"> </span><span class="k">FROM</span><span class="w">   </span><span class="p">[</span><span class="n">dbo</span><span class="p">].[</span><span class="n">MFValueList</span><span class="p">]</span>
<span class="w"> </span><span class="k">WHERE</span><span class="w">  </span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;Country&#39;</span>

<span class="w"> </span><span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="p">[</span><span class="n">MFValueListItems</span><span class="p">]</span><span class="w"> </span><span class="p">(</span><span class="w">   </span><span class="p">[</span><span class="n">Name</span><span class="p">]</span>
<span class="w">          </span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="n">Process_ID</span><span class="p">]</span>
<span class="w">          </span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="n">DisplayID</span><span class="p">]</span>
<span class="w">          </span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="n">MFValueListID</span><span class="p">]</span>
<span class="w">           </span><span class="p">)</span>
<span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="s1">&#39;Russia&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;RU&#39;</span><span class="p">,</span><span class="w"> </span><span class="o">@</span><span class="n">Valuelist_ID</span><span class="w"> </span><span class="p">)</span>


<span class="w"> </span><span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="p">[</span><span class="n">MFValueListItems</span><span class="p">]</span><span class="w"> </span><span class="p">(</span><span class="w">   </span><span class="p">[</span><span class="n">Name</span><span class="p">]</span>
<span class="w">          </span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="n">Process_ID</span><span class="p">]</span>
<span class="w">          </span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="n">MFValueListID</span><span class="p">]</span>
<span class="w">           </span><span class="p">)</span>
<span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="s1">&#39;Argentina&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="o">@</span><span class="n">Valuelist_ID</span><span class="w"> </span><span class="p">)</span>


<span class="c1">--DELETE VALUELIST ITEM (note that the procedure will delete the valuelist item only and not the related objects)</span>
<span class="c1">--the record will not be deleted from the table, however, the deleted column will be set to 1.</span>

<span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span>
<span class="w"> </span><span class="k">FROM</span><span class="w">   </span><span class="p">[</span><span class="n">MFvwCountry</span><span class="p">]</span>

<span class="w"> </span><span class="k">UPDATE</span><span class="w"> </span><span class="p">[</span><span class="n">mvli</span><span class="p">]</span>
<span class="w"> </span><span class="k">SET</span><span class="w">    </span><span class="p">[</span><span class="n">Process_ID</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span>
<span class="w"> </span><span class="c1">--select *</span>
<span class="w"> </span><span class="k">FROM</span><span class="w">   </span><span class="p">[</span><span class="n">MFValuelistitems</span><span class="p">]</span><span class="w"> </span><span class="p">[</span><span class="n">mvli</span><span class="p">]</span>
<span class="w"> </span><span class="k">WHERE</span><span class="w">  </span><span class="p">[</span><span class="n">mvli</span><span class="p">].[</span><span class="n">AppRef</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;2#154#9&#39;</span>


<span class="c1">--PROCESS UPDATE</span>
<span class="w"> </span><span class="k">EXEC</span><span class="w"> </span><span class="p">[</span><span class="n">spMFSynchronizeValueListItemsToMFiles</span><span class="p">]</span>

<span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span>
<span class="w"> </span><span class="k">FROM</span><span class="w">   </span><span class="p">[</span><span class="n">MFvwCountry</span><span class="p">]</span>
</pre></div>
</div>
</section>
</section>
<section id="update-records-from-sql-to-m-files">
<h2>Update records from SQL to M-Files<a class="headerlink" href="#update-records-from-sql-to-m-files" title="Link to this heading"></a></h2>
<p>Executing spMFUpdateTable with Updatemethod = 0 will push rows with a
process_id = 1 from SQL to M-Files</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">EXEC</span><span class="w"> </span><span class="p">[</span><span class="n">dbo</span><span class="p">].[</span><span class="n">spMFUpdateTable</span><span class="p">]</span><span class="w"> </span><span class="o">@</span><span class="n">MFTableName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;MFCustomer&#39;</span><span class="p">,</span>
<span class="w">                             </span><span class="o">@</span><span class="n">UpdateMethod</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
</pre></div>
</div>
<p>Use the bulk upload procedure when updating a large number of records</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">EXEC</span><span class="w"> </span><span class="p">[</span><span class="n">dbo</span><span class="p">].[</span><span class="n">spMFUpdateTableinBatches</span><span class="p">]</span><span class="w"> </span><span class="o">@</span><span class="n">MFTableName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;YourTable&#39;</span>
<span class="w">                                     </span><span class="p">,</span><span class="o">@</span><span class="n">UpdateMethod</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">                                     </span><span class="p">,</span><span class="o">@</span><span class="n">WithStats</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
<span class="w">                                     </span><span class="p">,</span><span class="o">@</span><span class="n">Debug</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
</pre></div>
</div>
<p>Exclude the stats when using the above procedure as part of a extended
procedure that is part of integration code</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">EXEC</span><span class="w"> </span><span class="p">[</span><span class="n">dbo</span><span class="p">].[</span><span class="n">spMFUpdateTableinBatches</span><span class="p">]</span><span class="w"> </span><span class="o">@</span><span class="n">MFTableName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;YourTable&#39;</span>
<span class="w">                                     </span><span class="p">,</span><span class="o">@</span><span class="n">UpdateMethod</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">                                     </span><span class="p">,</span><span class="o">@</span><span class="n">WithStats</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">                                     </span><span class="p">,</span><span class="o">@</span><span class="n">Debug</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
</pre></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../importing-files-from-explorer/import-file-example/index.html" class="btn btn-neutral float-left" title="Example procedure for importing sales invoices on demand" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../integration-vendor-approval/index.html" class="btn btn-neutral float-right" title="Integration for vendor approval" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Laminin Solutions Ltd.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>