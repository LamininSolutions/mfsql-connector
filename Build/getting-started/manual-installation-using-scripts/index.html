

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Manual installation using scripts &mdash; MFSQL Connector 4.10.30.74 documentation</title>
  

  
  
    <link rel="shortcut icon" href="../../_static/MFSQL-Favicon.ico"/>
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Content Package installation" href="content-package-installation/index.html" />
    <link rel="prev" title="Setup powershell utilities" href="../configuration-and-setup/setup-powershell-utilities/index.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> MFSQL Connector
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">FAQ:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../faq/index.html">Frequently asked questions</a></li>
</ul>
<p class="caption"><span class="caption-text">MFSQL Connector Guide:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../introduction/index.html">Introduction to MFSQL</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Getting Started</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../installation-overview/index.html">Installation Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../on-premise-installation/index.html">On Premise Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cloud-and-hosted-installation/index.html">M-Files Cloud and other hosted installations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../high-availability-sql-servers/index.html">High Availability SQL Servers installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../configuration-and-setup/index.html">Configuration and setup</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Manual installation using scripts</a><ul>
<li class="toctree-l3"><a class="reference internal" href="content-package-installation/index.html">Content Package installation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../database-file-connector-installation/index.html">Database file connector installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../upgrades-and-hotfixes/index.html">Upgrades and hotfixes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../next-steps-after-installation/index.html">Next Steps after installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../next-steps-after-installation/index.html#using-example-scripts">Using example scripts</a></li>
<li class="toctree-l2"><a class="reference internal" href="../common-installation-errors-and-resolutions/index.html">Common installation errors and resolutions</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../mfsql-data-exchange-and-reporting-connector/index.html">MFSQL Data Exchange and reporting Connector</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../mfsql-database-file-connector/index.html">MFSQL Database File Connector</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../mfsql-integration-connector/index.html">MFSQL Integration Connector</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../the-connector-framework/index.html">The Connector Framework</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../version-control/index.html">Version Control</a></li>
</ul>
<p class="caption"><span class="caption-text">Blog:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../blogs/index.html">List of blogs</a></li>
</ul>
<p class="caption"><span class="caption-text">SQL Components:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../procedures/index.html">Procedures</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tables/index.html">Tables</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../functions/index.html">Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../views/index.html">Views</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">MFSQL Connector</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">Getting Started</a> &raquo;</li>
        
      <li>Manual installation using scripts</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="manual-installation-using-scripts">
<h1>Manual installation using scripts<a class="headerlink" href="#manual-installation-using-scripts" title="Permalink to this headline">¶</a></h1>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="content-package-installation/index.html">Content Package installation</a></li>
</ul>
</div>
<p>In special use cases in may be required to install or upgrade MFSQL Connector manually.</p>
<p>Manual installation may be necessary in the following scenarios:</p>
<blockquote>
<div><ul class="simple">
<li><p>Security policy on the SQL Server prevents Powershell scripts from running on the server.</p></li>
<li><p>Security policy on the SQL Server prevents the MFSQL Connector package to run on the server.</p></li>
<li><p>The scripts to be installed on the SQL Server must be separately validated by a DBA and executed independently from the package installation.</p></li>
</ul>
</div></blockquote>
<p>The following steps must be completed for each vault. The details of each step follows below:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>Run the installation package for the latest version on a workstation.</p></li>
<li><p>Install the VAF (vault applications) and configurations on the M-Files server</p></li>
<li><p>Install the scripts on the SQL server</p></li>
<li><p>Run the startup procedures on the SQL Server</p></li>
</ol>
</div></blockquote>
<p><strong>1. Prior to installation.</strong></p>
<ul class="simple">
<li><p>M-Files Desktop must be installed on the workstation prior to commencing with the package installation.</p></li>
<li><p>Ensure that M-Files Desktop is also installed on the SQL Server and make a note of the M-Files version number.</p></li>
<li><p>Download the latest package from the Website.  The latest published release is available from the <a class="reference external" href="https://lamininsolutions.com/download-mfsql-connector/">Laminin Solutions website</a></p></li>
</ul>
<p><strong>2. Install package on workstation.</strong></p>
<blockquote>
<div><ul>
<li><p>The installation package of the Connector allows for creating the installation package on a workstation and then to use the components of the installation package ready to be copied to the servers.</p></li>
<li><p>The installation will not perform any operations on the M-Files Server or SQL Server.</p></li>
<li><p>The installation files will be place in the installation folders on the workstation</p>
<blockquote>
<div><ul class="simple">
<li><p>C:\Program Files (x86)\Laminin Solutions\MFSQL Connector Release 4\[Database Name]</p></li>
<li><p>C:\MFSQL\Assemblies</p></li>
</ul>
</div></blockquote>
</li>
<li><p>Run the installation on the workstation with the selections outlined below.</p></li>
</ul>
</div></blockquote>
<p>The installation folder selected in step 1 below will include the files for the manual installations</p>
<p><img alt="image1" src="../../_images/Image1.png" /></p>
<p>Select options 1 and 2 below for all workstation installations.</p>
<p><img alt="image2" src="../../_images/Image2.png" /></p>
<p>Complete the vault connection setup for the steps below:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>Vault name as per the M-Files Admin module</p></li>
<li><p>The name and password of the dedicated user for MFSQL Connector operations in the vault.</p></li>
<li><p>Fill in the Domain if a windows user applies.</p></li>
<li><p>Select authentication type from drop down</p></li>
<li><p>Select the protocol from the dropdown</p></li>
<li><p>Add the port for the vault.</p></li>
<li><p>Enter the M-Files version number on the SQL Server, for example 21.9.10629.5 The version is available by hovering over the M-Files logo on the server.  Take care not to confuse the workstation version and the SQL server version.</p></li>
<li><p>Update the path of the installation of M-Files on the SQL server if it is not the default path</p></li>
<li><p>Enter the DNS address for the M-Files Server.</p></li>
</ol>
</div></blockquote>
<p><img alt="image3" src="../../_images/Image3.png" /></p>
<p>The following image illustrated a completed form for a cloud Vault</p>
<p><img alt="image4" src="../../_images/Image4.png" /></p>
<p>Complete the installation as described in the on-premise installation instruction.</p>
<p><strong>3. Copy assembly files.</strong></p>
<p>Copy the related installation files to the server.  The files in the following folders must be copied to the SQL server</p>
<blockquote>
<div><ul class="simple">
<li><p>All Assemblies in the folder C:\MFSQL\Assemblies on the workstation must be copied to C:\MFSQL\Assemblies on the SQL Server</p></li>
<li><p>The assemblies should be copied for each upgrade as they may have changed. It is possible to check on the file version of the assemblies to determine if the file have changed.</p></li>
</ul>
</div></blockquote>
<p><img alt="image9" src="../../_images/Image9.png" /></p>
<p><strong>4. Copy vault related files.</strong></p>
<p>Copy the following folders to the M-Files server.  This is only necessary if MFSQL Connector on the M-Files server is a new install or an upgrade where the VAF version changed.</p>
<blockquote>
<div><ul class="simple">
<li><p>C:\Program Files (x86)\Laminin Solutions\MFSQL Connector Release 4\[Database Name]\Content Package</p></li>
<li><p>C:\Program Files (x86)\Laminin Solutions\MFSQL Connector Release 4\[Database Name]\Vault Applications\MFSQL_VAF</p></li>
</ul>
</div></blockquote>
<p><img alt="image10" src="../../_images/Image10.png" /></p>
<p><strong>5. Installation on M-Files Server.</strong></p>
<p>The installation on the M-Files Server must always take place in advance of the SQL server when a new installation is performed. In the case of an upgrade, the installation on the M-Files server can be skipped, unless a change in the vault application was made. The version of the vault application is evident indicted in a change of the VAF version or from the <a class="reference internal" href="../../version-control/index.html"><span class="doc">Version Control</span></a> page</p>
<p>First time installation:</p>
<blockquote>
<div><ul class="simple">
<li><p>Install the content package from C:\Program Files (x86)\Laminin Solutions\MFSQL Connector Release 4\[Database Name]\Content Package using the M-Files Admin one time import in Content Replication and Archiving.</p></li>
<li><p>Install the VAF from C:\Program Files (x86)\Laminin Solutions\MFSQL Connector Release 4\[Database Name]\Vault Applications\MFSQL_VAF</p></li>
<li><p>Configure the context menu functionality as outlined in <a class="reference internal" href="../configuration-and-setup/installing-the-context-menu/index.html"><span class="doc">Installing the Context Menu</span></a> , if required</p></li>
<li><p>Obtain a license from us and install the license.</p></li>
</ul>
</div></blockquote>
<p>Upgrade:</p>
<blockquote>
<div><ul class="simple">
<li><p>The VAF can be installed directly into the vault using the Applications window from the folder C:\Program Files (x86)\Laminin Solutions\MFSQL Connector Release 4\[Database Name]\Vault Applications\MFSQL_VAF</p></li>
</ul>
</div></blockquote>
<p><strong>5. Installation on SQL Server .</strong></p>
<p>Before commencing, ensure that the latest Assemblies have been copied to the server, and that M-Files Desktop is installed on the server.</p>
<p>Using SSMS from the workstation (or directly on the server), open the following scripts from the folder C:\Program Files (x86)\Laminin Solutions\MFSQL Connector Release 4\[Database Name]\Database scripts\[latest version]\</p>
<blockquote>
<div><ul class="simple">
<li><p>10_Setup-[version].sql</p></li>
<li><p>20_CLR-[version].sql</p></li>
<li><p>30_Data_Exchange-[version].sql</p></li>
<li><p>35_Intergation-[version].sql</p></li>
</ul>
</div></blockquote>
<p>Execute the 4 scripts in sequence. Each script will show a listing of routines in the message tab.  Note the following:</p>
<blockquote>
<div><ul class="simple">
<li><p>On a new installation, the database will automatically be created.</p></li>
<li><p>Do NOT use the same scripts for multiple MFSQL Connector databases.  The name of the database is imbedded in each script. New scripts must be created for each MFSQL Connector database.</p></li>
<li><p>The messages may show ‘missing objects’. This is only a warning and can be ignored.</p></li>
</ul>
<p><img alt="image7" src="../../_images/Image7.png" /></p>
<ul class="simple">
<li><p>If the execution result shows a failure, scroll down to the section shown in red, make a screenshot and report it to <a class="reference external" href="mailto:support&#37;&#52;&#48;lamininsolutions&#46;com">support<span>&#64;</span>lamininsolutions<span>&#46;</span>com</a>.  Stop processing of the remainder of the scripts.</p></li>
</ul>
</div></blockquote>
<p><strong>6. Installation the assemblies .</strong></p>
<p>On completion of the 4 scripts, execute the following to install the assemblies</p>
<p>If the installation of the assemblies failed, then validate that the following is correct:</p>
<blockquote>
<div><ul class="simple">
<li><p>the correct M-Files Version on the SQL server was used (select * from MFSettings to validate)</p></li>
<li><p>the Assemblies was copied to the correct path as specified above</p></li>
<li><p>M-Files desktop was installed to the folder specified in the package creation.</p></li>
</ul>
</div></blockquote>
<p>If any of these settings is incorrect then the package must be re-generated and the entire process must be repeated.</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">EXEC</span> <span class="n">spmfupdateassemblies</span>
</pre></div>
</div>
<p><strong>7. Update the password .</strong></p>
<ul class="simple">
<li><p>Encrypt the password</p></li>
</ul>
<p>Use the password for the M-Files user dedicated for MFSQL Connector</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">EXEC</span> <span class="n">dbo</span><span class="p">.</span><span class="n">spMFSettingsForVaultUpdate</span>
<span class="o">@</span><span class="n">Password</span> <span class="o">=</span> <span class="s1">&#39;the password of the M-Files user&#39;</span>
</pre></div>
</div>
<p><strong>7. Validate the installation .</strong></p>
<p>This procedure will check that license is valid and connection to M-Files can be established. This concludes the manual installation.</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">EXEC</span> <span class="n">spmfvaultconnectionTest</span>
</pre></div>
</div>
<p>The expected outcome</p>
<blockquote>
<div><p><img alt="image8" src="../../_images/Image8.png" /></p>
</div></blockquote>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="content-package-installation/index.html" class="btn btn-neutral float-right" title="Content Package installation" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../configuration-and-setup/setup-powershell-utilities/index.html" class="btn btn-neutral float-left" title="Setup powershell utilities" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Laminin Solutions Ltd

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>