

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>M-Files automatic upgrade &mdash; MFSQL Connector 4.9.27.69 documentation</title>
  

  
  
    <link rel="shortcut icon" href="../../../_static/MFSQL-Favicon.ico"/>
  
  
  

  
  <script type="text/javascript" src="../../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Upgrading version 4.8.22.62 or later" href="../updating-to-version-4.8.22.62/index.html" />
    <link rel="prev" title="Upgrades and hotfixes" href="../index.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../index.html" class="icon icon-home"> MFSQL Connector
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">FAQ:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../faq/index.html">Frequently asked questions</a></li>
</ul>
<p class="caption"><span class="caption-text">MFSQL Connector Guide:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../introduction/index.html">Introduction to MFSQL</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../index.html">Getting Started</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../installation-overview/index.html">Installation Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../first-time-installation/index.html">First time installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../manual-installation-using-scripts/index.html">Manual installation using scripts</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../licensing-management/index.html">Licensing Management</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../next-steps-after-installation/index.html">Next Steps after installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../next-steps-after-installation/index.html#using-example-scripts">Using example scripts</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../index.html">Upgrades and hotfixes</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">M-Files automatic upgrade</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#methods-to-update-mfsql-connector">Methods to update MFSQL Connector</a></li>
<li class="toctree-l4"><a class="reference internal" href="#assembly-related-errors">Assembly related errors</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../updating-to-version-4.8.22.62/index.html">Upgrading version 4.8.22.62 or later</a></li>
<li class="toctree-l3"><a class="reference internal" href="../index.html#types-of-upgrades">Types of Upgrades</a></li>
<li class="toctree-l3"><a class="reference internal" href="../index.html#preparation-for-upgrading">Preparation for upgrading</a></li>
<li class="toctree-l3"><a class="reference internal" href="../index.html#automatic-updates">Automatic updates</a></li>
<li class="toctree-l3"><a class="reference internal" href="../index.html#manual-update-of-the-connector">Manual update of the Connector</a></li>
<li class="toctree-l3"><a class="reference internal" href="../index.html#upgrade-the-connector-to-a-new-version">Upgrade the Connector to a new version</a></li>
<li class="toctree-l3"><a class="reference internal" href="../index.html#version-check">Version Check</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../update-settings/index.html">Update settings</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../setup-database/index.html">Set-up and working with Connector Database</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../database-mail/index.html">Database Mail</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../index.html#quick-steps-for-a-new-installation">Quick steps for a new installation.</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../mfsql-data-exchange-and-reporting-connector/index.html">MFSQL Data Exchange and reporting Connector</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../mfsql-database-file-connector/index.html">MFSQL Database File Connector</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../mfsql-integration-connector/index.html">MFSQL Integration Connector</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../the-connector-framework/index.html">The Connector Framework</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../version-control/index.html">Version Control</a></li>
</ul>
<p class="caption"><span class="caption-text">Blog:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../blogs/index.html">List of blogs</a></li>
</ul>
<p class="caption"><span class="caption-text">SQL Components:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../procedures/index.html">Procedures</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../tables/index.html">Tables</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../functions/index.html">Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../views/index.html">Views</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">MFSQL Connector</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../../index.html">Getting Started</a> &raquo;</li>
        
          <li><a href="../index.html">Upgrades and hotfixes</a> &raquo;</li>
        
      <li>M-Files automatic upgrade</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="m-files-automatic-upgrade">
<h1>M-Files automatic upgrade<a class="headerlink" href="#m-files-automatic-upgrade" title="Permalink to this headline">¶</a></h1>
<p>M-Files automatically upgrades to keep the M-Files software up to date.</p>
<p>MFSQL Connector must response to the upgrade of M-Files on the SQL Server. MFSQL Connector requires M-Files Desktop on the SQL Server where MFSQL Connector is deployed. When M-Files upgrades on the SQL Server it moves the location of the MFilesAPI to the new installed version. MFSQL Connector must therefore be updated to repoint the MFileAPI in the CLR Assemblies to the new location.</p>
<div class="section" id="methods-to-update-mfsql-connector">
<h2>Methods to update MFSQL Connector<a class="headerlink" href="#methods-to-update-mfsql-connector" title="Permalink to this headline">¶</a></h2>
<ol class="arabic simple">
<li><p>Automatic Update</p></li>
</ol>
<p>The Connector checks to validate if M-Files has upgraded by running the procedure <a class="reference external" href="https://doc.lamininsolutions.com/mfsql-connector/procedures/spMFCheckAndUpdateAssemblyVersion">spMFCheckAndUpdateAssemblyVersion</a>.  This procedure can be run manually using <a class="reference external" href="https://doc.lamininsolutions.com/mfsql-connector/procedures/spMFUpdateAssemblies">spMFUpdateAssemblies</a>, using a <a class="reference external" href="https://doc.lamininsolutions.com/mfsql-connector/getting-started/first-time-installation/using-agent-for-automated-updates/index.html">SQL agent</a> , or using a <a class="reference external" href="https://doc.lamininsolutions.com/mfsql-connector/getting-started/first-time-installation/setup-powershell-utilities/">powershell utility</a>.  Use the powershell utility for SQL Express installations.</p>
<ol class="arabic simple">
<li><p>Manual update</p></li>
</ol>
<p>Set the parameter to the current version of M-Files on the SQL Server then execute.</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">EXEC</span> <span class="p">[</span><span class="n">dbo</span><span class="p">].[</span><span class="n">spMFUpdateAssemblies</span><span class="p">]</span> <span class="o">@</span><span class="n">MfilesVersion</span> <span class="o">=</span> <span class="s1">&#39;19.9.8028.5&#39;</span>
</pre></div>
</div>
<ol class="arabic simple">
<li><p>Rerun the installation package</p></li>
</ol>
<p>Another way to reset the assemblies is to re-run the installation package of the MFSQL Connector.</p>
<ol class="arabic simple">
<li><p>Check the M-files version on the SQL Server</p></li>
</ol>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">Declare</span> <span class="o">@</span><span class="n">IsUpdateAssembly</span> <span class="nb">int</span><span class="p">,</span> <span class="o">@</span><span class="n">MFilesVersion</span> <span class="n">nvarchar</span><span class="p">(</span><span class="mi">25</span><span class="p">)</span>
<span class="k">Exec</span> <span class="n">spMFGetMFilesAssemblyVersion</span> <span class="o">@</span><span class="n">IsUpdateAssembly</span> <span class="o">=</span> <span class="o">@</span><span class="n">IsUpdateAssembly</span> <span class="k">output</span><span class="p">,</span> <span class="o">@</span><span class="n">MFilesVersion</span> <span class="o">=</span> <span class="o">@</span><span class="n">MFilesVersion</span> <span class="k">output</span>
<span class="k">Select</span> <span class="o">@</span><span class="n">IsUpdateAssembly</span> <span class="k">as</span> <span class="n">IsUpdateRequired</span><span class="p">,</span> <span class="o">@</span><span class="n">MFilesVersion</span> <span class="k">as</span> <span class="n">InstalledVersion</span>
</pre></div>
</div>
</div>
<div class="section" id="assembly-related-errors">
<h2>Assembly related errors<a class="headerlink" href="#assembly-related-errors" title="Permalink to this headline">¶</a></h2>
<p>An error reporting a missing procedure or that the assembly could not be found is usually an indication that the updating of the assemblies did not work.</p>
<p>Check the following:</p>
<blockquote>
<div><ul class="simple">
<li><p>Check the agent or powershell utility to verify that the update is running as expected.</p></li>
<li><p>If the Connector is running updates regularly during the day, then it is advisable to ensure the agent runs say every half hour to catch any unexpected automatic M-Files updates.</p></li>
<li><p>Running the updates, especially with Connector versions prior to 4.8.24.65 may result in the dropping of the CLR assemblies, without reloading the assemblies.  Run exec spmfUpdateAssemblies &#64;MfilesVersion = ‘the current version on the SQL server’ to fix.</p></li>
</ul>
</div></blockquote>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../updating-to-version-4.8.22.62/index.html" class="btn btn-neutral float-right" title="Upgrading version 4.8.22.62 or later" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../index.html" class="btn btn-neutral float-left" title="Upgrades and hotfixes" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Laminin Solutions Ltd

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>