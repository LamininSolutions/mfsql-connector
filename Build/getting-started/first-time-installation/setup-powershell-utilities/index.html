

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Setup powershell utilities &mdash; MFSQL Connector 4.9.29.73 documentation</title>
  

  
  
    <link rel="shortcut icon" href="../../../_static/MFSQL-Favicon.ico"/>
  
  
  

  
  <script type="text/javascript" src="../../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Install package with logging" href="../install-package-with-logging/index.html" />
    <link rel="prev" title="Common installation errors and resolutions" href="../common-installation-errors-and-resolutions/index.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../index.html" class="icon icon-home"> MFSQL Connector
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">FAQ:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../faq/index.html">Frequently asked questions</a></li>
</ul>
<p class="caption"><span class="caption-text">MFSQL Connector Guide:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../introduction/index.html">Introduction to MFSQL</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../index.html">Getting Started</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../installation-overview/index.html">Installation Overview</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../index.html">First time installation</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../standard-new-installation/index.html">Standard Installation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../content-package-installation/index.html">Content Package installation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../installing-the-context-menu/index.html">Installing the Context Menu</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration-of-connection-string/index.html">Configuration of connection string</a></li>
<li class="toctree-l3"><a class="reference internal" href="../install-webapi/index.html">Installing the Web API</a></li>
<li class="toctree-l3"><a class="reference internal" href="../database-file-connector-installation/index.html">Database file connector installation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../using-agent-for-automated-updates/index.html">Using Agent for automated updates</a></li>
<li class="toctree-l3"><a class="reference internal" href="../common-installation-errors-and-resolutions/index.html">Common installation errors and resolutions</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Setup powershell utilities</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#location-of-powershell-utilities">Location of powershell utilities</a></li>
<li class="toctree-l4"><a class="reference internal" href="#automation-and-scheduling-of-procedures-for-sql-express">Automation and scheduling of procedures for SQL Express</a></li>
<li class="toctree-l4"><a class="reference internal" href="#file-importing">File Importing</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../install-package-with-logging/index.html">Install package with logging</a></li>
<li class="toctree-l3"><a class="reference internal" href="../index.html#installation-scenarios">Installation scenarios</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../manual-installation-using-scripts/index.html">Manual installation using scripts</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../licensing-management/index.html">Licensing Management</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../next-steps-after-installation/index.html">Next Steps after installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../next-steps-after-installation/index.html#using-example-scripts">Using example scripts</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../upgrades-and-hotfixes/index.html">Upgrades and hotfixes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../update-settings/index.html">Update settings</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../setup-database/index.html">Set-up and working with Connector Database</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../database-mail/index.html">Database Mail</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../index.html#quick-steps-for-a-new-installation">Quick steps for a new installation.</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../mfsql-data-exchange-and-reporting-connector/index.html">MFSQL Data Exchange and reporting Connector</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../mfsql-database-file-connector/index.html">MFSQL Database File Connector</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../mfsql-integration-connector/index.html">MFSQL Integration Connector</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../the-connector-framework/index.html">The Connector Framework</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../version-control/index.html">Version Control</a></li>
</ul>
<p class="caption"><span class="caption-text">Blog:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../blogs/index.html">List of blogs</a></li>
</ul>
<p class="caption"><span class="caption-text">SQL Components:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../procedures/index.html">Procedures</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../tables/index.html">Tables</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../functions/index.html">Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../views/index.html">Views</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">MFSQL Connector</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../../index.html">Getting Started</a> &raquo;</li>
        
          <li><a href="../index.html">First time installation</a> &raquo;</li>
        
      <li>Setup powershell utilities</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="setup-powershell-utilities">
<h1>Setup powershell utilities<a class="headerlink" href="#setup-powershell-utilities" title="Permalink to this headline">¶</a></h1>
<p>Powershell utilities is provided on an as-is basis to enhance the flexibility and deployment of distinct scenarios</p>
<div class="section" id="location-of-powershell-utilities">
<h2>Location of powershell utilities<a class="headerlink" href="#location-of-powershell-utilities" title="Permalink to this headline">¶</a></h2>
<p>The utilities is included in the installation package and can be found in the MFSQL Connector installation folder the 60_addOns subfolder.</p>
<blockquote>
<div><ul class="simple">
<li><p>FolderExport_V3 is a utility to aid importing routines and is used to get the file locations in a network drive.</p></li>
<li><p>SQLScheduler_V3.4 is a utility to use windows scheduler to run SQL procedures.</p></li>
</ul>
</div></blockquote>
<p>The powershell utilities is provided as-is examples and applications to extent MFSQL Connector. We recommend to engage with us for the use and deployment of these utilities to complete the setup and running of the utilities in your environment.</p>
<p>The utilities require Powershell 5.0 + and SQLServer module to access the SQL Server.
To install powershell modules run \library\FE_Module_install in powershell as administrator in sequence.</p>
</div>
<div class="section" id="automation-and-scheduling-of-procedures-for-sql-express">
<h2>Automation and scheduling of procedures for SQL Express<a class="headerlink" href="#automation-and-scheduling-of-procedures-for-sql-express" title="Permalink to this headline">¶</a></h2>
<p>SQL Express does not allow the use of agents.  The Powershell utility SQLScheduler_V3.4 enables scheduled procedures for SQL Express scenarios.</p>
<p>This utility is intended as an alternative for using SQL Agent for scheduling MFQL Connector procedures
This is particularly relevant when using SQL Express for running the following processes for any number of databases in a server:</p>
<blockquote>
<div><ul class="simple">
<li><p>Automating the MFVersion update : MFVersionUpdate</p></li>
<li><p>Updating all class tables for reporting : UpdateAllTables</p></li>
<li><p>Deleting history : DeleteHistory</p></li>
</ul>
</div></blockquote>
<p>The utility can be included in windows task scheduler to be run with set intervals. Each Setup XML file points to a specific Server. The server can have multiple databases to be processed (e.g. production and test, or different vaults) and each database can have multiple predefined processes that can be scheduled in the task scheduler.    A separate bat file is required for each process.</p>
<p>The following bat file is provided as an example.
MFSQLSchedule_UpdateAllIncludedInAppTables.bat for running spMFUpdateAllIncludedInAppTables with &#64;UpdateMethod = 1, &#64;Isdeleted = 1</p>
<p>The results of the most recent update is recorded in the processlog. \logs\processeslog.txt
Any errors are recorded in the errorlog. \logs\errorlog.txt</p>
<div class="section" id="prerequisites">
<h3>Prerequisites<a class="headerlink" href="#prerequisites" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><ul class="simple">
<li><p>Powershell 5.0 + is required.</p></li>
<li><p>SQLServer module is required to access the SQL Server.  Use the PS script in /library to test and install this module.</p></li>
<li><p>Run the routine with windows credentials with access to SQL and the MFSQL Connector database</p></li>
<li><p>The connection string is set to use windows integrated security. Run the bat file as administrator if the current user does not have admin rights and have execution rights on the SQL server and databases</p></li>
</ul>
</div></blockquote>
</div>
<div class="section" id="content-of-the-package">
<h3>Content of the package<a class="headerlink" href="#content-of-the-package" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><ul class="simple">
<li><p>MFSQLScheduler_Main.ps1 : this is the main routine. Use bat file to execute each procedure.  Do not execute the ps1 file directly.</p></li>
<li><p>xxx.bat : used to execute the main routine. A separate bat is used for each procedure. Refer to the section below for modifying bat file.</p></li>
<li><p>SQLScheduler.XML : The main configuration file. A separate configuration file is required for each database. Refer to different section to setup.</p></li>
<li><p>\Library\ : the library contains the functions called by the main routine.</p></li>
<li><p>\Log\ : error and processing log. folder and files are created by utility.</p></li>
</ul>
</div></blockquote>
</div>
<div class="section" id="setup">
<h3>Setup<a class="headerlink" href="#setup" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><ul class="simple">
<li><p>Open MFSQLScheduler.xml with notepad or a xml editor.</p></li>
</ul>
<blockquote>
<div><ul class="simple">
<li><p>modify the SQLScheduler\ApplicationPath to match the filepath where this utility is saved.</p></li>
<li><p>modify SQLScheduler\TargetDB\Server to set the target server for the SQL destination</p></li>
<li><p>modify SQLScheduler\TargetDB\Database to set the name of the Database to export to and enable disable each process to be included.</p></li>
</ul>
</div></blockquote>
<ul class="simple">
<li><p>The main application makes provision for setting up multiple databases and multiple processes per database</p></li>
<li><p>DO NOT CHANGE the names of the processes. Only change the true / false for the IsIncluded attribute indicating if the process should be included for the specific database</p></li>
<li><p>Each process has been setup to use default parameters. Changes to these parameters are unique to the underlying procedure and should only be changed in exceptional cases.</p></li>
<li><p>The sample XML include sample data, including a sample second database for illustration. Delete the extra database node if you are not using multiple databases.</p></li>
</ul>
</div></blockquote>
</div>
<div class="section" id="bat-file">
<h3>Bat File<a class="headerlink" href="#bat-file" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><ul class="simple">
<li><p>Use a separate bat file for each process. The app include sample bat files for the processes that can be used.</p></li>
<li><p>Open bat file with notepad</p></li>
<li><p>Modify the string after -Command to reference the path of the main routine + setupfilename + processname</p></li>
<li><p>spaces and case matters.</p></li>
</ul>
</div></blockquote>
<p>Example:
E:\Development\TFS\LSApplications\Powershell_Apps\SQLScheduler\MFSQLScheduler_Main.ps1 MFSQLScheduler.xml UpdateAllTables”</p>
</div>
<div class="section" id="windows-task-scheduler">
<h3>Windows task scheduler<a class="headerlink" href="#windows-task-scheduler" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><ul class="simple">
<li><p>Schedule the process to run automatically at predefined intervals using windows task scheduler.</p></li>
<li><p>Execute the bat file using the standard windows task scheduler setup.</p></li>
<li><p>Run the bat file with windows permission as outlined above.</p></li>
</ul>
</div></blockquote>
</div>
</div>
<div class="section" id="file-importing">
<h2>File Importing<a class="headerlink" href="#file-importing" title="Permalink to this headline">¶</a></h2>
<p>The File importing utility FolderExport_v3 is built to get the name and location of files in explorer or network drive.  A powershell utility is used to update SQL with the file and folder data from explorer.</p>
<p>This utility will export structured folder and file data from explorer for a specific directory to a) CSV files b) tables in an SQL database.</p>
<p>The csv files and table names are based on the settings in the setup file and will be created automatically. When rerunning the process the csv files and tables will be reset.</p>
<p>The data includes the file hash for file extensions in the setup file.  Note that the inclusion of the hash will increase the runtime of the process significantly, especially has the hash extensions include large files such as videos, zip files etc.</p>
<div class="section" id="file-import-prerequisites">
<h3>File import prerequisites<a class="headerlink" href="#file-import-prerequisites" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><ul class="simple">
<li><p>Powershell 5.0 + is required.</p></li>
<li><p>SQLServer module is required for the export to the SQL database</p></li>
<li><p>Run with windows credentials with access to SQL and the explorer file structure.</p></li>
<li><p>Access to SQL is based on using windows integrated security</p></li>
</ul>
</div></blockquote>
</div>
<div class="section" id="file-import-content-of-the-package">
<h3>File import content of the package<a class="headerlink" href="#file-import-content-of-the-package" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><ul class="simple">
<li><p>FolderExport_Main.ps1 : this is the main routine.  Use FolderExport.bat to execute.</p></li>
<li><p>FolderExport.bat : used to execute the main routine. Refer to different section for modifying bat file.</p></li>
<li><p>FolderListExport.XML : the main configuration file. Refer to different section to setup.</p></li>
<li><p>\Library\ : the library contains the functions calls by the main routine.</p></li>
<li><p>\Log\ : error and processing log. folder is created by utility and level of logging is dependent on the options selected in the bat file.</p></li>
<li><p>\CSV\: csv output for the folder and file listing. file name is set in configuration file.</p></li>
</ul>
</div></blockquote>
</div>
<div class="section" id="output-of-file-import">
<h3>Output of File import<a class="headerlink" href="#output-of-file-import" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><ul class="simple">
<li><p>Related to files:</p></li>
</ul>
</div></blockquote>
<p>[FileName] - file name without path
[Extension] - file extension
[SubPath] - file path excluding the root
[FullPath] - full path including the file name
[Length] - length in bytes (devide by 1024 to get kilo bytes
[Creation] - file creation date
[LastAccess] - date when file was last accessed
[LastWrite] - date when file was last written
[Attributes] - file attributes
[IsContainer] - show if directory
[RootPath] - file root used in the extraction, as per setup file
[Hash] - file hash, include on files with extensions set it setup file</p>
<ul class="simple">
<li><p>Related to folders</p></li>
</ul>
<p>[Path] - path root
[Drive] - drive
[Parent] - parent name
[Folder] - folder name
[FullPath] - path, including root
[PathFileCount] - count of files in path
[PathSize] - total of all files in path
[FolderFileCount] - count of files in folder
[FolderSize] - total of files in folder
[Root] -  root used in the extraction, as per setup file</p>
</div>
<div class="section" id="setup-of-file-import">
<h3>Setup of File Import<a class="headerlink" href="#setup-of-file-import" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><ul class="simple">
<li><p>Open FolderlistExport.xml with notepad or a xml editor.</p></li>
</ul>
<blockquote>
<div><ul class="simple">
<li><p>modify the FileImporter\ApplicationPath to match the filepath where this utility is saved.</p></li>
<li><p>modify FileImporter\Folders\Folder\Root to the root filepath where the files and folders for exporting is located</p></li>
<li><p>modify FileImporter\Folders\Folder\ShortName to set the name of the CSV file and Database Table name.</p></li>
<li><p>modify FileImporter\Folders\Folder\HasExtensions to set the file extensions for which to include the hash. List must be comma delimited and include the period. Generating the hash for the files significantly increase the run time. Hash is used to identify duplication files.</p></li>
<li><p>modify FileImporter\TargetDB\Server to set the target server for the SQL destination</p></li>
<li><p>modify FileImporter\TargetDB\Database to set the name of the Database to export to.</p></li>
</ul>
</div></blockquote>
</div></blockquote>
</div>
<div class="section" id="file-import-bat-file">
<h3>File import Bat file<a class="headerlink" href="#file-import-bat-file" title="Permalink to this headline">¶</a></h3>
<p>Open FolderExport.bat with notepad. Modify the string after -Command to reference the path of the main routine.</p>
<p>Note this command line is set to use basic process logging (the default parameter)
There are three switches</p>
<blockquote>
<div><ul class="simple">
<li><p>Switch 1:  This switch are only used in exceptional cases. Should be set to $False</p></li>
<li><p>Switch 2:  Used for debugging individual file issues and produce detail record of updates when set to $True. Default is $False</p></li>
<li><p>Switch 3:  This switch will block updating SQL database tables automatically. Set this switch to $False if the csv files will be imported manually.</p></li>
</ul>
</div></blockquote>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../install-package-with-logging/index.html" class="btn btn-neutral float-right" title="Install package with logging" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../common-installation-errors-and-resolutions/index.html" class="btn btn-neutral float-left" title="Common installation errors and resolutions" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Laminin Solutions Ltd

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>