

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Using Agent for automated updates &mdash; MFSQL Connector 4.9.27.69 documentation</title>
  

  
  
    <link rel="shortcut icon" href="../../../_static/MFSQL-Favicon.ico"/>
  
  
  

  
  <script type="text/javascript" src="../../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Common installation errors and resolutions" href="../common-installation-errors-and-resolutions/index.html" />
    <link rel="prev" title="Database file connector installation" href="../database-file-connector-installation/index.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../index.html" class="icon icon-home"> MFSQL Connector
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">FAQ:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../faq/index.html">Frequently asked questions</a></li>
</ul>
<p class="caption"><span class="caption-text">MFSQL Connector Guide:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../introduction/index.html">Introduction to MFSQL</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../index.html">Getting Started</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../installation-overview/index.html">Installation Overview</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../index.html">First time installation</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../standard-new-installation/index.html">Standard New Installation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../content-package-installation/index.html">Content Package installation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../installing-the-context-menu/index.html">Installing the Context Menu</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration-of-connection-string/index.html">Configuration of connection string</a></li>
<li class="toctree-l3"><a class="reference internal" href="../install-webapi/index.html">Installing the Web API</a></li>
<li class="toctree-l3"><a class="reference internal" href="../database-file-connector-installation/index.html">Database file connector installation</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Using Agent for automated updates</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#update-class-tables">Update Class Tables</a></li>
<li class="toctree-l4"><a class="reference internal" href="#delete-history-agent">Delete History Agent</a></li>
<li class="toctree-l4"><a class="reference internal" href="#validate-m-files-version-agent">Validate M-Files Version Agent</a></li>
<li class="toctree-l4"><a class="reference internal" href="#staging-updates-with-agents">Staging updates with agents</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../common-installation-errors-and-resolutions/index.html">Common installation errors and resolutions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../setup-powershell-utilities/index.html">Setup powershell utilities</a></li>
<li class="toctree-l3"><a class="reference internal" href="../install-package-with-logging/index.html">Install package with logging</a></li>
<li class="toctree-l3"><a class="reference internal" href="../index.html#installation-scenarios">Installation scenarios</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../manual-installation-using-scripts/index.html">Manual installation using scripts</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../licensing-management/index.html">Licensing Management</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../next-steps-after-installation/index.html">Next Steps after installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../next-steps-after-installation/index.html#using-example-scripts">Using example scripts</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../upgrades-and-hotfixes/index.html">Upgrades and hotfixes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../update-settings/index.html">Update settings</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../setup-database/index.html">Set-up and working with Connector Database</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../database-mail/index.html">Database Mail</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../index.html#quick-steps-for-a-new-installation">Quick steps for a new installation.</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../mfsql-data-exchange-and-reporting-connector/index.html">MFSQL Data Exchange and reporting Connector</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../mfsql-database-file-connector/index.html">MFSQL Database File Connector</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../mfsql-integration-connector/index.html">MFSQL Integration Connector</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../the-connector-framework/index.html">The Connector Framework</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../version-control/index.html">Version Control</a></li>
</ul>
<p class="caption"><span class="caption-text">Blog:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../blogs/index.html">List of blogs</a></li>
</ul>
<p class="caption"><span class="caption-text">SQL Components:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../procedures/index.html">Procedures</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../tables/index.html">Tables</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../functions/index.html">Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../views/index.html">Views</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">MFSQL Connector</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../../index.html">Getting Started</a> &raquo;</li>
        
          <li><a href="../index.html">First time installation</a> &raquo;</li>
        
      <li>Using Agent for automated updates</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="using-agent-for-automated-updates">
<h1>Using Agent for automated updates<a class="headerlink" href="#using-agent-for-automated-updates" title="Permalink to this headline">¶</a></h1>
<blockquote>
<div><p>SQL Agent is not available for SQL Express editions.  Use the <a class="reference external" href="https://doc.lamininsolutions.com/mfsql-connector/getting-started/first-time-installation/setup-powershell-utilities/index.html">powershell utilities</a> for scheduled operations for SQL Express scenarios.</p>
</div></blockquote>
<p>SQL Agent is used to schedule a range of operations for the Connector.
The installation package will automatically install two agents.  Other
agents can be used to perform any number of operations. Updating class
table on a schedule is very common.</p>
<p>Agents will be installed for each Connector database for the following</p>
<ol class="arabic simple">
<li><p>MFSQL Delete History</p></li>
<li><p>MFSQL Validated M-Files Version</p></li>
</ol>
<div class="section" id="update-class-tables">
<h2>Update Class Tables<a class="headerlink" href="#update-class-tables" title="Permalink to this headline">¶</a></h2>
<p>The installation package does not automatically create an agent for
scheduling the update of the class tables.</p>
<p>If it is appropriate to update all class tables simultaneously on a
schedule then use spMFUpdateAllIncludedInAppTables in the agent.
Include the following script as a step in the agent.</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span> <span class="k">EXEC</span> <span class="p">[</span><span class="n">dbo</span><span class="p">].[</span><span class="n">spMFUpdateAllncludedInAppTables</span><span class="p">]</span>
 <span class="o">@</span><span class="n">UpdateMethod</span> <span class="o">=</span> <span class="mi">1</span>
<span class="p">,</span><span class="o">@</span><span class="n">RemoveDeleted</span> <span class="o">=</span> <span class="mi">1</span>
<span class="p">,</span><span class="o">@</span><span class="n">IsIncremental</span> <span class="o">=</span> <span class="mi">1</span>
</pre></div>
</div>
<p>Consider adding the powershell utility to update the M-Files version in combination with the agent when the SQL Server is separate from the M-Files server and the M-Files Version is likely to get out of sync between the servers.</p>
</div>
<div class="section" id="delete-history-agent">
<h2>Delete History Agent<a class="headerlink" href="#delete-history-agent" title="Permalink to this headline">¶</a></h2>
<p>The agent calls spMFDeleteHistory and is set to run once a month to
delete history older than 90 days. The following tables are included in
the deletion:</p>
<ul class="simple">
<li><p>MFLog</p></li>
<li><p>MFUpdateHistory</p></li>
<li><p>MFAuditHistory</p></li>
<li><p>MFProcessBatchDetail</p></li>
<li><p>MFProcessBatch</p></li>
</ul>
</div>
<div class="section" id="validate-m-files-version-agent">
<h2>Validate M-Files Version Agent<a class="headerlink" href="#validate-m-files-version-agent" title="Permalink to this headline">¶</a></h2>
<p>The agent calls the procedure spMFCheckAndUpdateAssemblyVersion. It
can be set to run once a day or more regularly if required.  The time can be adjusted to fit in
with other scheduled agents.  Note that any other Connector operations
will fail during the time that the assemblies are updated.</p>
</div>
<div class="section" id="staging-updates-with-agents">
<h2>Staging updates with agents<a class="headerlink" href="#staging-updates-with-agents" title="Permalink to this headline">¶</a></h2>
<p>Sometimes it is necessary to ensure one agent is completed before
another kicks in, or to check if a agent is running before a procedure
is executed.  We included an example procedure in the Demonstrate
Functions ‘70.104.Eample - Start Job wait - Agent’ to assist with this
type of operation.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../common-installation-errors-and-resolutions/index.html" class="btn btn-neutral float-right" title="Common installation errors and resolutions" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../database-file-connector-installation/index.html" class="btn btn-neutral float-left" title="Database file connector installation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Laminin Solutions Ltd

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>