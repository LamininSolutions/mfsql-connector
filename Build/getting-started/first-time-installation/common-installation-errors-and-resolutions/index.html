

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Common installation errors and resolutions &mdash; MFSQL Connector 4.9.27.69 documentation</title>
  

  
  
    <link rel="shortcut icon" href="../../../_static/MFSQL-Favicon.ico"/>
  
  
  

  
  <script type="text/javascript" src="../../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Setup powershell utilities" href="../setup-powershell-utilities/index.html" />
    <link rel="prev" title="Using Agent for automated updates" href="../using-agent-for-automated-updates/index.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../index.html" class="icon icon-home"> MFSQL Connector
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">FAQ:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../faq/index.html">Frequently asked questions</a></li>
</ul>
<p class="caption"><span class="caption-text">MFSQL Connector Guide:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../introduction/index.html">Introduction to MFSQL</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../index.html">Getting Started</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../installation-overview/index.html">Installation Overview</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../index.html">First time installation</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../standard-new-installation/index.html">Standard New Installation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../content-package-installation/index.html">Content Package installation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../installing-the-context-menu/index.html">Installing the Context Menu</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration-of-connection-string/index.html">Configuration of connection string</a></li>
<li class="toctree-l3"><a class="reference internal" href="../install-webapi/index.html">Installing the Web API</a></li>
<li class="toctree-l3"><a class="reference internal" href="../database-file-connector-installation/index.html">Database file connector installation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../using-agent-for-automated-updates/index.html">Using Agent for automated updates</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Common installation errors and resolutions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#vaultconnectiontest-fails">VaultConnectionTest fails</a></li>
<li class="toctree-l4"><a class="reference internal" href="#unable-to-log-into-m-files">Unable to log into M-Files</a></li>
<li class="toctree-l4"><a class="reference internal" href="#unable-to-connect-to-vault">Unable to connect to vault</a></li>
<li class="toctree-l4"><a class="reference internal" href="#exec-spmfsyncronizemetadata-produces-an-error-email">Exec spMFSyncronizeMetadata produces an error / email</a></li>
<li class="toctree-l4"><a class="reference internal" href="#network-connection-error-on-login-to-the-vault-for-the-first-time">Network connection error on login to the vault for the first time</a></li>
<li class="toctree-l4"><a class="reference internal" href="#mfsql-connector-context-menu-error">MFSQL Connector context menu error</a></li>
<li class="toctree-l4"><a class="reference internal" href="#emailprofile-error">EmailProfile Error</a></li>
<li class="toctree-l4"><a class="reference internal" href="#mflog-shows-error-for-invalid-license">MFLog shows error for invalid license</a></li>
<li class="toctree-l4"><a class="reference internal" href="#no-such-interface-supported">No such interface supported</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../setup-powershell-utilities/index.html">Setup powershell utilities</a></li>
<li class="toctree-l3"><a class="reference internal" href="../install-package-with-logging/index.html">Install package with logging</a></li>
<li class="toctree-l3"><a class="reference internal" href="../index.html#installation-scenarios">Installation scenarios</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../manual-installation-using-scripts/index.html">Manual installation using scripts</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../licensing-management/index.html">Licensing Management</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../next-steps-after-installation/index.html">Next Steps after installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../next-steps-after-installation/index.html#using-example-scripts">Using example scripts</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../upgrades-and-hotfixes/index.html">Upgrades and hotfixes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../update-settings/index.html">Update settings</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../setup-database/index.html">Set-up and working with Connector Database</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../database-mail/index.html">Database Mail</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../index.html#quick-steps-for-a-new-installation">Quick steps for a new installation.</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../mfsql-data-exchange-and-reporting-connector/index.html">MFSQL Data Exchange and reporting Connector</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../mfsql-database-file-connector/index.html">MFSQL Database File Connector</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../mfsql-integration-connector/index.html">MFSQL Integration Connector</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../the-connector-framework/index.html">The Connector Framework</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../version-control/index.html">Version Control</a></li>
</ul>
<p class="caption"><span class="caption-text">Blog:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../blogs/index.html">List of blogs</a></li>
</ul>
<p class="caption"><span class="caption-text">SQL Components:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../procedures/index.html">Procedures</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../tables/index.html">Tables</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../functions/index.html">Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../views/index.html">Views</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">MFSQL Connector</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../../index.html">Getting Started</a> &raquo;</li>
        
          <li><a href="../index.html">First time installation</a> &raquo;</li>
        
      <li>Common installation errors and resolutions</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="common-installation-errors-and-resolutions">
<h1>Common installation errors and resolutions<a class="headerlink" href="#common-installation-errors-and-resolutions" title="Permalink to this headline">¶</a></h1>
<p>The following errors or issues may be experienced during the installation process</p>
<div class="section" id="vaultconnectiontest-fails">
<h2>VaultConnectionTest fails<a class="headerlink" href="#vaultconnectiontest-fails" title="Permalink to this headline">¶</a></h2>
<p>Unable to make a connection with error: Could not find procedure ‘dbo.spMFDecrypt’</p>
<p><img alt="image1" src="../../../_images/2021-03-04_03-58-59.png" /></p>
<p>This error arise when a upgrade or installation could not find the M-Files installation version or the procedure spMFUpdateAssemblies was executed without specifying the parameter but could not find the assembly folders.</p>
<p><img alt="image2" src="../../../_images/2021-03-04_04-00-31.png" /></p>
<p>The error will happen when the CLR procedures are missing. Inspecting the listing of procedures in SSMS explorer will show that the CLR procedures are missing.
Listing with CLR procedures.  The CLR procedures have a ‘lock’ icon as shown below.</p>
<p><img alt="image4" src="../../../_images/2021-03-04_04-02-31.png" /></p>
<p>Listing where CLR procedures are missing</p>
<p><img alt="image3" src="../../../_images/2021-03-04_04-01-11.png" /></p>
<p>Run the procedure spMFUpdateAssemblies with the parameter specifying the correct M-Files version</p>
<p><img alt="image5" src="../../../_images/2021-03-04_04-04-10.png" /></p>
<p>The results should not show any errors.  If it still showing an error then refer to the section on trapping connection errors.</p>
</div>
<div class="section" id="unable-to-log-into-m-files">
<h2>Unable to log into M-Files<a class="headerlink" href="#unable-to-log-into-m-files" title="Permalink to this headline">¶</a></h2>
<p>Probable causes:</p>
<ul class="simple">
<li><p>Corrupt / old connection remnant on server</p></li>
<li><p>Unable to connect to M-Files using the login credentials</p></li>
</ul>
<p>Solution:</p>
<blockquote>
<div><ul class="simple">
<li><p>Check the error log (see screenshot)</p></li>
<li><p>Delete content of the c:_users_[loginuser]_AppData_MFSQL Vault Install folder</p></li>
<li><p>Alternatively one can delete the VaultSettings.xml file in the this folder</p></li>
<li><p>check the settings to log into the correct M-Files Server</p></li>
</ul>
</div></blockquote>
<p><img alt="img1" src="../../../_images/img_43.jpg" /></p>
<p>Example of error</p>
<p><img alt="img2" src="../../../_images/img_51.jpg" /></p>
<p>Watch the video</p>
<iframe width="560" height="315" src="https://www.youtube.com/embed/WVsB6MQ6cgg" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe></div>
<div class="section" id="unable-to-connect-to-vault">
<h2>Unable to connect to vault<a class="headerlink" href="#unable-to-connect-to-vault" title="Permalink to this headline">¶</a></h2>
<p>Probable causes:</p>
<blockquote>
<div><ul class="simple">
<li><p>The settings for connecting to the vault is incorrect or could not be installed</p></li>
<li><p>The server security settings does not allow powershell scripts</p></li>
<li><p>The M-Files password changed</p></li>
</ul>
</div></blockquote>
<p>Solution:</p>
<blockquote>
<div><ul class="simple">
<li><p>Update settings using spMFSettingsForVaultUpdate</p></li>
</ul>
</div></blockquote>
<p><img alt="img3" src="../../../_images/img_61.jpg" /></p>
</div>
<div class="section" id="exec-spmfsyncronizemetadata-produces-an-error-email">
<h2>Exec spMFSyncronizeMetadata produces an error / email<a class="headerlink" href="#exec-spmfsyncronizemetadata-produces-an-error-email" title="Permalink to this headline">¶</a></h2>
<p>Probable causes:</p>
<ul class="simple">
<li><p>The licensing is not valid / or has not been activated</p></li>
</ul>
<p>Solution:</p>
<ul class="simple">
<li><p>Install the license for MFSQL Connector and log into the vault using a desktop client</p></li>
</ul>
<p><img alt="img4" src="../../../_images/img_71.jpg" /></p>
</div>
<div class="section" id="network-connection-error-on-login-to-the-vault-for-the-first-time">
<h2>Network connection error on login to the vault for the first time<a class="headerlink" href="#network-connection-error-on-login-to-the-vault-for-the-first-time" title="Permalink to this headline">¶</a></h2>
<p>Probable causes:</p>
<blockquote>
<div><ul class="simple">
<li><p>The connection string is invalid</p></li>
<li><p>The SQL licensing has not taken place and the connector will not operate.</p></li>
</ul>
</div></blockquote>
<p>Solution:</p>
<blockquote>
<div><ul class="simple">
<li><p>search for ‘connectionstring’ in the vault and update the connection string.</p></li>
<li><p>Log out of vault</p></li>
<li><p>Uninstall the MFSQL Connector vault application in M-Files, reinstall, and relicense</p></li>
<li><p>Log back into vault</p></li>
</ul>
</div></blockquote>
<p><img alt="img5" src="../../../_images/img_81.jpg" /></p>
</div>
<div class="section" id="mfsql-connector-context-menu-error">
<h2>MFSQL Connector context menu error<a class="headerlink" href="#mfsql-connector-context-menu-error" title="Permalink to this headline">¶</a></h2>
<p>Probable causes:</p>
<ul class="simple">
<li><p>The connection string is invalid</p></li>
</ul>
<p>Solution:</p>
<blockquote>
<div><ul class="simple">
<li><p>search for ‘connectionstring’ in the vault and update the connection string</p></li>
<li><p>log out and log back into vault.</p></li>
</ul>
</div></blockquote>
<p><img alt="img6" src="../../../_images/img_9.jpg" /></p>
</div>
<div class="section" id="emailprofile-error">
<h2>EmailProfile Error<a class="headerlink" href="#emailprofile-error" title="Permalink to this headline">¶</a></h2>
<p>Probable causes:</p>
<ul class="simple">
<li><p>When procedures are executed  with an error the message appears</p></li>
<li><p>Note that this error also indicates that there was an error</p></li>
</ul>
<p>Solution:</p>
<blockquote>
<div><ul class="simple">
<li><p>Install Database Mail and set the profile name to ‘MailProfile’</p></li>
<li><p>Check MFLog table for error messages</p></li>
</ul>
</div></blockquote>
<p><img alt="img7" src="../../../_images/img_10.jpg" /></p>
</div>
<div class="section" id="mflog-shows-error-for-invalid-license">
<h2>MFLog shows error for invalid license<a class="headerlink" href="#mflog-shows-error-for-invalid-license" title="Permalink to this headline">¶</a></h2>
<p>Probable causes:</p>
<blockquote>
<div><ul class="simple">
<li><p>Indicates the license has an issue</p></li>
</ul>
</div></blockquote>
<p>Solution:</p>
<blockquote>
<div><ul class="simple">
<li><p>Check that license has been added to the vault application</p></li>
<li><p>Check Configurations / other applications / MFSQL Connector VaultApp Dashboard to see if it loading properly.  If it iscorrect, then uninstall and manually re-install the vault application from the installation files.</p></li>
</ul>
</div></blockquote>
</div>
<div class="section" id="no-such-interface-supported">
<h2>No such interface supported<a class="headerlink" href="#no-such-interface-supported" title="Permalink to this headline">¶</a></h2>
<p>Sometimes after an upgrade errors appear with ‘No such interface supported’ in the error description. It is likely that the error will also refer to an older version of M-Files.</p>
<p>An example is below:
A .NET Framework error occurred during execution of user-defined routine or aggregate “spMFCreatePublicSharedLinkInternal”: System.Runtime.InteropServices.COMException: No such interface supported. CoVaultObjectOperations.cpp, 2462, No such interface supported. (0x80004002) Helper.cpp, 745, No such interface supported. (0x80004002) (M-Files 21.1.9827.4) (0028) System.Runtime.InteropServices.COMException: at LSConnect.MFiles.MFilesAccess.GetPublicLink(Int32 ObjectID, Int32 pDay, Int32 pMonth, Int32 pYear) at MFilesWrapper.GetPublicSharedLink(String VaultSettings, String XML, String&amp; OutputXml) .</p>
<p>Probable cause:</p>
<p>One of the applications that is using the M-Files API’s has loaded the previous version into memory.  The upgrade will not automatically release these older versions. However, MFSQL Connector cannot find the previous version.</p>
<p>Solution:</p>
<p>Restart the SQL server service.  If this does not resolve the issue, restart the SQL server.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../setup-powershell-utilities/index.html" class="btn btn-neutral float-right" title="Setup powershell utilities" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../using-agent-for-automated-updates/index.html" class="btn btn-neutral float-left" title="Using Agent for automated updates" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Laminin Solutions Ltd

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>